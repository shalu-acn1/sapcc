import{T as M,U as we,a as ae}from"./chunk-EU5ZHKTW.js";import{B as rt,C as ot,Ha as Se,Ia as mt,J as te,K as at,Ka as De,Kb as ut,L as st,La as dt,Lb as be,M as ie,Oa as ne,P as q,Pa as re,X as ye,Z as he,_ as pt,b as tt,ba as Ie,c as P,d as xe,e as ge,g as _e,j as G,jc as oe,ka as lt,l as ve,o as Ce,p as Ee,pb as Te,s as it,tc as ft,w as nt,xa as ct}from"./chunk-H2QHHFZD.js";import{$b as l,Ab as v,Ac as Ke,Af as Ze,Ag as Z,Bb as c,Ca as H,Cc as A,Cd as Xe,D as le,Dg as V,Eb as Ae,Eg as ee,Gd as Je,Hb as Ge,Ib as qe,Ic as Y,Jb as Ue,Kb as j,Kd as K,Lb as u,M as ce,Mb as ze,Mf as X,Nb as f,Pa as r,Pf as J,Qf as ue,Sb as He,Tb as me,U as Be,Ub as W,Wa as g,Ya as D,Za as T,a as Ve,ab as je,ac as m,bb as x,bc as I,c as $e,ca as ke,d as Oe,da as z,ec as L,ga as Re,hb as Q,ib as o,ma as R,mb as Le,n as B,na as S,ng as et,pa as N,q as k,r as Pe,sb as s,sg as fe,tb as p,ub as _,va as C,vb as b,wa as E,wb as w,wc as Qe,xc as F,yb as h,yc as We,zc as Ye,zf as de}from"./chunk-PRP3ZKGZ.js";import{a as $,b as O}from"./chunk-25N2FLV6.js";var se=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=R({token:t,factory:function(i){let n=null;return i?n=new(i||t):n=N(Je),n},providedIn:"root"})}}return t})(),U=function(t){return t.FILE_NAME="fileName",t.DATE_TIME="dateTime",t}(U||{}),St={cartImportExport:{file:{separator:","},import:{fileValidity:{maxSize:1,maxEntries:{[M.NEW_SAVED_CART]:100,[M.SAVED_CART]:100,[M.ACTIVE_CART]:10,[M.QUICK_ORDER]:10},allowedTypes:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv",".csv"]},cartNameGeneration:{source:U.FILE_NAME}},export:{additionalColumns:[{name:{key:"name"},value:"product.name"},{name:{key:"price"},value:"totalPrice.formattedValue"}],messageEnabled:!0,downloadDelay:1e3,maxEntries:1e3,fileOptions:{fileName:"cart",extension:"csv",type:"text/csv"}}}},gt=(()=>{class t{static forRoot(){return{ngModule:t,providers:[K(St)]}}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=T({type:t})}static{this.\u0275inj=S({})}}return t})();ie.IMPORT_TO_CART="IMPORT_TO_CART";function Tt(t,d){if(t&1){let e=h();s(0,"button",1),v("click",function(){let n=C(e).ngIf,a=c();return E(a.exportCsv(n))}),u(1),l(2,"cxTranslate"),p()}t&2&&(r(),f(" ",m(2,1,"exportEntries.exportProductToCsv"),`
`))}var bt=["open"];function wt(t,d){if(t&1){let e=h();s(0,"button",1),v("click",function(){let n=C(e).ngIf,a=c();return E(a.openDialog(n))}),u(1),l(2,"cxTranslate"),p()}t&2&&(r(),f(" ",m(2,1,"importEntries.importProducts"),`
`))}var _t=()=>({autofocus:".cx-message"});function Ft(t,d){if(t&1&&(_(0,"cx-message",11),l(1,"cxTranslate")),t&2){let e=c(3);o("text",m(1,4,"importEntriesDialog.selectedSuccessfully"))("type",e.globalMessageType.MSG_TYPE_CONFIRMATION)("isVisibleCloseButton",!1)("cxFocus",me(6,_t))}}function Mt(t,d){if(t&1&&(b(0),s(1,"div",9),x(2,Ft,2,7,"cx-message",10),p(),w()),t&2){let e,i=c(2);r(2),o("ngIf",((e=i.form.get("file"))==null?null:e.value)&&((e=i.form.get("file"))==null?null:e.valid))}}function Nt(t,d){if(t&1){let e=h();s(0,"form",1),v("submit",function(){C(e);let n=c();return E(n.formSubmitSubject$.next(void 0))}),x(1,Mt,3,1,"ng-container",2),s(2,"p",3),u(3),l(4,"cxTranslate"),p(),s(5,"p"),u(6),l(7,"cxTranslate"),p(),s(8,"label")(9,"cx-file-upload",4),u(10),l(11,"cxTranslate"),p(),_(12,"cx-form-errors",5),p(),s(13,"div",6)(14,"button",7),v("click",function(){C(e);let n=c();return E(n.close("Close Import Products Dialog"))}),u(15),l(16,"cxTranslate"),p(),s(17,"button",8),u(18),l(19,"cxTranslate"),p()()()}if(t&2){let e,i=c();o("formGroup",i.form),r(),o("cxFeature","a11yCartImportConfirmationMessage"),r(2),f(" ",m(4,11,"importEntriesDialog.importProductsSubtitle")," "),r(3),f(" ",m(7,13,"importEntriesDialog.importProductFileDetails")," "),r(3),o("formControl",i.form.get("file"))("accept",i.allowedTypes),r(),f(" ",m(11,15,"importEntriesDialog.selectFile")," "),r(2),o("control",i.form.get("file")),r(3),f(" ",m(16,17,"importEntriesDialog.cancel")," "),r(2),o("disabled",((e=i.form.get("file"))==null?null:e.status)==="PENDING"),r(),f(" ",m(19,19,"importEntriesDialog.upload")," ")}}var Fe=t=>({count:t});function Vt(t,d){if(t&1&&(b(0),u(1),l(2,"cxTranslate"),w()),t&2){let e=c(2);r(),f(" ",I(2,1,"importEntriesDialog.summary.loaded",e.summary)," ")}}function $t(t,d){if(t&1&&(b(0),u(1),l(2,"cxTranslate"),w()),t&2){let e=c(2);r(),f(" ",I(2,1,"importEntriesDialog.summary.loadedToCart",e.summary)," ")}}function Ot(t,d){if(t&1&&(s(0,"p",9),x(1,Vt,3,4,"ng-container",10)(2,$t,3,4,"ng-container",11),p()),t&2){let e=c();o("ngSwitch",e.type),r(),o("ngSwitchCase",e.orderEntriesSource.QUICK_ORDER)}}function Pt(t,d){if(t&1&&(s(0,"p"),u(1),l(2,"cxTranslate"),p()),t&2){let e=c();r(),f(" ",I(2,1,"importEntriesDialog.summary.loading",e.summary)," ")}}function Bt(t,d){if(t&1&&(s(0,"p",12),_(1,"cx-icon",13),u(2),l(3,"cxTranslate"),p()),t&2){let e=c();r(),o("type",e.iconTypes.SUCCESS),r(),f(" ",I(3,2,"importEntriesDialog.summary.successes",e.summary),`
`)}}function kt(t,d){if(t&1&&(s(0,"li"),u(1),l(2,"cxTranslate"),p()),t&2){let e=d.$implicit;r(),f(" ",I(2,1,"importEntriesDialog.summary.messages."+e.statusCode,e)," ")}}function Rt(t,d){if(t&1&&(s(0,"ul"),x(1,kt,3,4,"li",18),p()),t&2){let e=c(2);r(),o("ngForOf",e.summary.warningMessages)}}function jt(t,d){if(t&1){let e=h();s(0,"div",14)(1,"p"),_(2,"cx-icon",15),u(3),l(4,"cxTranslate"),s(5,"button",16),v("click",function(){C(e);let n=c();return E(n.toggleWarningList())}),u(6),l(7,"cxTranslate"),p()(),x(8,Rt,2,1,"ul",17),p()}if(t&2){let e=c();r(2),o("type",e.iconTypes.ERROR),r(),f(" ",I(4,4,"importEntriesDialog.summary.warning",W(9,Fe,e.summary.warningMessages.length))," "),r(3),f(" ",m(7,7,e.warningDetailsOpened?"importEntriesDialog.summary.hide":"importEntriesDialog.summary.show")," "),r(2),o("ngIf",e.warningDetailsOpened)}}function Lt(t,d){if(t&1&&(s(0,"li"),u(1),l(2,"cxTranslate"),p()),t&2){let e=d.$implicit;r(),f(" ",I(2,1,"importEntriesDialog.summary.messages."+e.statusCode,e)," ")}}function At(t,d){if(t&1&&(s(0,"ul"),x(1,Lt,3,4,"li",18),p()),t&2){let e=c(2);r(),o("ngForOf",e.summary.errorMessages)}}function Gt(t,d){if(t&1){let e=h();s(0,"div",19)(1,"p"),_(2,"cx-icon",20),u(3),l(4,"cxTranslate"),s(5,"button",16),v("click",function(){C(e);let n=c();return E(n.toggleErrorList())}),u(6),l(7,"cxTranslate"),p()(),x(8,At,2,1,"ul",17),p()}if(t&2){let e=c();r(2),o("type",e.iconTypes.RESET),r(),f(" ",I(4,4,"importEntriesDialog.summary.error",W(9,Fe,e.summary.errorMessages.length))," "),r(3),f(" ",m(7,7,e.errorDetailsOpened?"importEntriesDialog.summary.hide":"importEntriesDialog.summary.show")," "),r(2),o("ngIf",e.errorDetailsOpened)}}function qt(t,d){if(t&1){let e=h();s(0,"button",21),v("click",function(){C(e);let n=c();return E(n.close("Close Import Products Dialog"))}),u(1),l(2,"cxTranslate"),p()}t&2&&(r(),f(" ",m(2,1,"importEntriesDialog.close")," "))}function Ut(t,d){t&1&&(s(0,"p"),u(1),l(2,"cxTranslate"),p()),t&2&&(r(),ze(m(2,1,"importEntriesDialog.summary.info")))}function zt(t,d){if(t&1&&(_(0,"cx-message",19),l(1,"cxTranslate")),t&2){let e=c(3);o("text",m(1,4,"importEntriesDialog.selectedSuccessfully"))("type",e.globalMessageType.MSG_TYPE_CONFIRMATION)("isVisibleCloseButton",!1)("cxFocus",me(6,_t))}}function Ht(t,d){if(t&1&&(b(0),s(1,"div",17),x(2,zt,2,7,"cx-message",18),p(),w()),t&2){let e,i=c(2);r(2),o("ngIf",((e=i.form.get("file"))==null?null:e.value)&&((e=i.form.get("file"))==null?null:e.valid))}}function Qt(t,d){if(t&1){let e=h();s(0,"form",1),v("submit",function(){C(e);let n=c();return E(n.formSubmitSubject$.next(void 0))}),x(1,Ht,3,1,"ng-container",2),_(2,"cx-form-required-legend"),s(3,"p",3),u(4),l(5,"cxTranslate"),p(),s(6,"p"),u(7),l(8,"cxTranslate"),_(9,"cx-form-required-asterisks"),p(),s(10,"label")(11,"cx-file-upload",4),v("update",function(){C(e);let n=c();return E(n.updateCartName())}),u(12),l(13,"cxTranslate"),p(),_(14,"cx-form-errors",5),p(),s(15,"div",6)(16,"label")(17,"span",7),u(18),l(19,"cxTranslate"),_(20,"cx-form-required-asterisks"),p(),_(21,"input",8)(22,"cx-form-errors",9),p()(),s(23,"div",6)(24,"label")(25,"span",7),u(26),l(27,"cxTranslate"),s(28,"span",10),u(29),l(30,"cxTranslate"),p()(),_(31,"textarea",11)(32,"cx-form-errors",12),s(33,"p",13),u(34),l(35,"cxTranslate"),p()()(),s(36,"div",14)(37,"button",15),v("click",function(){C(e);let n=c();return E(n.close("Close Import Products Dialog"))}),u(38),l(39,"cxTranslate"),p(),s(40,"button",16),u(41),l(42,"cxTranslate"),p()()()}if(t&2){let e,i,n,a=c();o("formGroup",a.form),r(),o("cxFeature","a11yCartImportConfirmationMessage"),r(3),f(" ",m(5,23,"importEntriesDialog.importProductsNewSavedCartSubtitle")," "),r(3),f(" ",m(8,25,"importEntriesDialog.importProductFileDetails")," "),r(4),o("formControl",a.form.get("file"))("accept",a.allowedTypes),r(),f(" ",m(13,27,"importEntriesDialog.selectFile")," "),r(2),o("control",a.form.get("file")),r(4),f(" ",m(19,29,"importEntriesDialog.savedCartName")," "),r(3),o("maxLength",a.nameMaxLength),Q("aria-invalid",((e=a.form.get("name"))==null?null:e.touched)&&((e=a.form.get("name"))==null?null:e.invalid))("aria-errormessage","nameError"),r(),o("control",a.form.get("name")),r(4),f(" ",m(27,31,"importEntriesDialog.savedCartDescription")," "),r(3),f(" (",m(30,33,"importEntriesDialog.optional"),") "),r(2),o("maxLength",a.descriptionMaxLength),Q("aria-invalid",((i=a.form.get("description"))==null?null:i.touched)&&((i=a.form.get("description"))==null?null:i.invalid))("aria-errormessage","descriptionError"),r(),o("control",a.form.get("description")),r(2),f(" ",I(35,35,"importEntriesDialog.charactersLeft",W(42,Fe,a.descriptionsCharacterLeft))," "),r(4),f(" ",m(39,38,"importEntriesDialog.cancel")," "),r(2),o("disabled",((n=a.form.get("file"))==null?null:n.status)==="PENDING"),r(),f(" ",m(42,40,"importEntriesDialog.upload")," ")}}function Wt(t,d){t&1&&(s(0,"h3",10),u(1),l(2,"cxTranslate"),p()),t&2&&(r(),f(" ",m(2,1,"importEntriesDialog.importProducts")," "))}function Yt(t,d){t&1&&(s(0,"div",10),u(1),l(2,"cxTranslate"),p()),t&2&&(r(),f(" ",m(2,1,"importEntriesDialog.importProducts")," "))}function Kt(t,d){if(t&1){let e=h();s(0,"cx-import-to-new-saved-cart-form",13),v("submitEvent",function(n){C(e);let a=c(2).ngIf,y=c();return E(y.importProducts(a,n))}),p()}if(t&2){let e=c(2).ngIf;o("type",e.type)}}function Xt(t,d){if(t&1){let e=h();s(0,"cx-import-entries-form",13),v("submitEvent",function(n){C(e);let a=c(2).ngIf,y=c();return E(y.importProducts(a,n))}),p()}if(t&2){let e=c(2).ngIf;o("type",e.type)}}function Jt(t,d){if(t&1&&(b(0),x(1,Kt,1,1,"cx-import-to-new-saved-cart-form",12)(2,Xt,1,1,"ng-template",null,1,L),w()),t&2){let e=j(3),i=c().ngIf,n=c();r(),o("ngIf",n.isNewCartForm(i))("ngIfElse",e)}}function Zt(t,d){if(t&1){let e=h();s(0,"cx-import-entries-summary",14),l(1,"async"),v("closeEvent",function(){C(e);let n=c(2);return E(n.close("Close Import Products Dialog"))}),p()}if(t&2){let e=c().ngIf,i=c();o("summary",m(1,2,i.summary$))("type",e.type)}}function ei(t,d){if(t&1&&(b(0),x(1,Jt,4,2,"ng-container",11)(2,Zt,2,4,"ng-template",null,0,L),w()),t&2){let e=j(3),i=c();r(),o("ngIf",i.formState)("ngIfElse",e)}}function ti(t,d){t&1&&_(0,"cx-import-order-entries")}function ii(t,d){t&1&&_(0,"cx-export-order-entries")}var ni=(()=>{class t{constructor(e,i,n,a){this.exportCsvFileService=e,this.importExportConfig=i,this.globalMessageService=n,this.translationService=a,this.columns=[{name:{key:"code"},value:"product.code"},{name:{key:"quantity"},value:"quantity"},...this.exportConfig?.additionalColumns??[]]}get exportConfig(){return this.importExportConfig.cartImportExport?.export}get separator(){return this.importExportConfig.cartImportExport?.file.separator}downloadCsv(e){this.getResolvedEntries(e).pipe(ce(1)).subscribe(i=>this.download(i))}resolveValue(e,i){return e.split(".").reduce((n,a)=>n?n[a]:"",i)?.toString()??""}resolveValues(e){return e.map(i=>this.columns.map(n=>this.resolveValue(n.value,i)))}getTranslatedColumnHeaders(){return Pe(this.columns.map(e=>this.translationService.translate(`exportEntries.columnNames.${e.name.key}`)))}displayExportMessage(){this.globalMessageService.add({key:"exportEntries.exportMessage"},de.MSG_TYPE_INFO)}limitValues(e){return this.exportConfig?.maxEntries?e.splice(0,this.exportConfig?.maxEntries):e}getResolvedEntries(e){let i=this.limitValues(this.resolveValues(e));return this.getTranslatedColumnHeaders().pipe(k(n=>[n,...i]))}download(e){this.exportConfig?.messageEnabled&&this.displayExportMessage(),setTimeout(()=>{this.exportConfig!==void 0&&this.separator!==void 0&&this.exportCsvFileService.download(e,this.separator,this.exportConfig.fileOptions)},this.exportConfig?.downloadDelay??0)}static{this.\u0275fac=function(i){return new(i||t)(N(ut),N(se),N(Ze),N(et))}}static{this.\u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),vt=(()=>{class t{constructor(e,i){this.exportEntriesService=e,this.contextService=i,this.styles="container",this.orderEntriesContext$=this.contextService.get(ae),this.entries$=this.orderEntriesContext$.pipe(z(n=>n?.getEntries?.()??B(void 0)))}exportCsv(e){this.exportEntriesService.downloadCsv(e)}static{this.\u0275fac=function(i){return new(i||t)(g(ni),g(oe))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-export-order-entries"]],hostVars:2,hostBindings:function(i,n){i&2&&Le(n.styles)},standalone:!1,decls:3,vars:5,consts:[["class","btn btn-tertiary cx-export-btn",3,"click",4,"ngIf"],[1,"btn","btn-tertiary","cx-export-btn",3,"click"]],template:function(i,n){if(i&1&&(x(0,Tt,3,3,"button",0),l(1,"async"),l(2,"async")),i&2){let a;o("ngIf",((a=m(1,1,n.entries$))==null?null:a.length)>0&&m(2,3,n.entries$))}},dependencies:[F,A,V],encapsulation:2,changeDetection:0})}}return t})(),Me=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=T({type:t})}static{this.\u0275inj=S({imports:[Y,Xe,ee,fe,J.withConfig({cmsComponents:{ExportOrderEntriesComponent:{component:vt}}})]})}}return t})(),Ct=(()=>{class t{constructor(e,i){this.launchDialogService=e,this.contextService=i,this.subscription=new Ve,this.orderEntriesContext$=this.contextService.get(ae)}openDialog(e){this.launchDialogService.openDialogAndSubscribe(ie.IMPORT_TO_CART,this.element,{orderEntriesContext:e})}static{this.\u0275fac=function(i){return new(i||t)(g(q),g(oe))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-import-order-entries"]],viewQuery:function(i,n){if(i&1&&Ge(bt,5),i&2){let a;qe(a=Ue())&&(n.element=a.first)}},standalone:!1,decls:2,vars:3,consts:[["class","btn btn-tertiary cx-import-btn",3,"click",4,"ngIf"],[1,"btn","btn-tertiary","cx-import-btn",3,"click"]],template:function(i,n){i&1&&(x(0,wt,3,3,"button",0),l(1,"async")),i&2&&o("ngIf",m(1,1,n.orderEntriesContext$))},dependencies:[F,A,V],encapsulation:2,changeDetection:0})}}return t})(),Et=(()=>{class t{constructor(){}csvDataToProduct(e){return e.map(i=>({productCode:i[0],quantity:Number(i[1])}))}isDataParsableToProducts(e){let i=new RegExp(/(?:\s|^)\d+(?=\s|$)/);return e.length>0&&e.every(n=>i.test(n[1]))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),yt=(()=>{class t{constructor(e,i,n,a,y){this.launchDialogService=e,this.importToCartService=i,this.importCsvService=n,this.filesFormValidators=a,this.importExportConfig=y,this.formSubmitSubject$=new $e,this.globalMessageType=de,this.submitEvent=new H}ngOnInit(){this.form=this.buildForm(),this.formSubmitSubject$.pipe(Re(()=>{this.form.invalid&&(this.form.markAllAsTouched(),ft.deepUpdateValueAndValidity(this.form))}),z(()=>this.form.statusChanges.pipe(ke(this.form.get("file")?.status),le(e=>e!=="PENDING"),ce(1))),le(e=>e==="VALID")).subscribe(()=>{this.save()})}close(e){this.launchDialogService.closeDialog(e)}save(){let e=this.form.get("file")?.value?.[0];this.separator!==void 0&&this.importCsvService.loadFile(e,this.separator).subscribe(i=>{this.submitEvent.emit({products:this.importToCartService.csvDataToProduct(i)})})}buildForm(){let e=new _e({});return e.setControl("file",new G("",[P.required,this.filesFormValidators.maxSize(this.maxSize)],[i=>this.separator!==void 0?this.importCsvService.validateFile(i.value[0],{separator:this.separator,isDataParsable:this.importToCartService.isDataParsableToProducts,maxEntries:this.maxEntries}):B(null)])),e}get allowedTypes(){return this.importExportConfig.cartImportExport?.import?.fileValidity?.allowedTypes}get maxSize(){return this.importExportConfig.cartImportExport?.import?.fileValidity?.maxSize}get maxEntries(){return this.importExportConfig.cartImportExport?.import?.fileValidity?.maxEntries?.[this.type]}get separator(){return this.importExportConfig.cartImportExport?.file.separator}static{this.\u0275fac=function(i){return new(i||t)(g(q),g(Et),g(be),g(Te),g(se))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-import-entries-form"]],inputs:{type:"type"},outputs:{submitEvent:"submitEvent"},standalone:!1,decls:1,vars:1,consts:[[3,"formGroup","submit",4,"ngIf"],[3,"submit","formGroup"],[4,"cxFeature"],[1,"cx-import-entries-subtitle"],[3,"formControl","accept"],["prefix","formErrors.file",3,"control"],[1,"cx-import-entries-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],["aria-live","assertive","aria-atomic","true"],[3,"text","type","isVisibleCloseButton","cxFocus",4,"ngIf"],[3,"text","type","isVisibleCloseButton","cxFocus"]],template:function(i,n){i&1&&x(0,Nt,20,21,"form",0),i&2&&o("ngIf",n.form)},dependencies:[F,ve,xe,ge,Ce,Ee,Se,te,De,Ie,X,V],encapsulation:2,changeDetection:0})}}return t})(),ri=(()=>{class t{constructor(){this.iconTypes=ye,this.orderEntriesSource=M,this.warningDetailsOpened=!1,this.errorDetailsOpened=!1,this.closeEvent=new H}close(e){this.closeEvent.emit(e)}toggleWarningList(){this.warningDetailsOpened=!this.warningDetailsOpened}toggleErrorList(){this.errorDetailsOpened=!this.errorDetailsOpened}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=D({type:t,selectors:[["cx-import-entries-summary"]],inputs:{type:"type",summary:"summary"},outputs:{closeEvent:"closeEvent"},standalone:!1,decls:11,vars:7,consts:[["loading",""],["info",""],[1,"cx-import-entries-summary-status"],[3,"ngSwitch",4,"ngIf","ngIfElse"],["class","cx-import-entries-summary-successes",4,"ngIf"],["class","cx-import-entries-summary-warnings",4,"ngIf"],["class","cx-import-entries-summary-errors",4,"ngIf"],[1,"cx-import-entries-summary-footer"],["class","btn btn-secondary","type","button",3,"click",4,"ngIf","ngIfElse"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"cx-import-entries-summary-successes"],[1,"success",3,"type"],[1,"cx-import-entries-summary-warnings"],[1,"warning",3,"type"],[1,"btn","btn-tertiary",3,"click"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"cx-import-entries-summary-errors"],[1,"error",3,"type"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(i,n){if(i&1&&(s(0,"div",2),x(1,Ot,3,2,"p",3)(2,Pt,3,4,"ng-template",null,0,L),p(),x(4,Bt,4,5,"p",4)(5,jt,9,11,"div",5)(6,Gt,9,11,"div",6),s(7,"div",7),x(8,qt,3,3,"button",8)(9,Ut,3,3,"ng-template",null,1,L),p()),i&2){let a=j(3),y=j(10);r(),o("ngIf",!n.summary.loading)("ngIfElse",a),r(3),o("ngIf",n.summary.successesCount>0),r(),o("ngIf",n.summary.warningMessages.length>0),r(),o("ngIf",n.summary.errorMessages.length>0),r(2),o("ngIf",!n.summary.loading)("ngIfElse",y)}},dependencies:[Qe,F,We,Ye,Ke,he,V],encapsulation:2,changeDetection:0})}}return t})(),oi=(()=>{class t extends yt{get descriptionsCharacterLeft(){return this.descriptionMaxLength-(this.form.get("description")?.value?.length||0)}constructor(e,i,n,a,y,pe){super(e,i,n,a,y),this.launchDialogService=e,this.importToCartService=i,this.importCsvService=n,this.filesFormValidators=a,this.importExportConfig=y,this.datePipe=pe,this.descriptionMaxLength=250,this.nameMaxLength=50,this.submitEvent=new H}save(){let e=this.form.get("file")?.value?.[0];this.separator!==void 0&&this.importCsvService.loadFile(e,this.separator).subscribe(i=>{this.submitEvent.emit({products:this.importToCartService.csvDataToProduct(i),savedCartInfo:{name:this.form.get("name")?.value,description:this.form.get("description")?.value}})})}buildForm(){let e=new _e({});return e.setControl("file",new G("",[P.required,this.filesFormValidators.maxSize(this.maxSize)],[i=>this.separator!==void 0?this.importCsvService.validateFile(i.value[0],{separator:this.separator,isDataParsable:this.importToCartService.isDataParsableToProducts,maxEntries:this.maxEntries}):B(null)])),e.setControl("name",new G("",[P.required,P.maxLength(this.nameMaxLength)])),e.setControl("description",new G("",[P.maxLength(this.descriptionMaxLength)])),e}updateCartName(){let e=this.form.get("name");if(e&&!e?.value&&this.cartNameGeneration?.source)switch(this.cartNameGeneration.source){case U.FILE_NAME:{this.setFieldValueByFileName(e);break}case U.DATE_TIME:{this.setFieldValueByDatetime(e);break}default:break}}setFieldValueByFileName(e){let i=this.form.get("file")?.value?.[0]?.name?.replace(/\.[^/.]+$/,"");e.setValue(i)}setFieldValueByDatetime(e){let i=new Date,n=this.cartNameGeneration?.fromDateOptions,a=n?.mask,y=n?.prefix??"",pe=n?.suffix??"",It=a?this.datePipe.transform(i,a):this.datePipe.transform(i);e.setValue(`${y}${It}${pe}`)}get cartNameGeneration(){return this.importExportConfig.cartImportExport?.import?.cartNameGeneration}static{this.\u0275fac=function(i){return new(i||t)(g(q),g(Et),g(be),g(Te),g(se),g(Z))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-import-to-new-saved-cart-form"]],outputs:{submitEvent:"submitEvent"},standalone:!1,features:[He([Z]),je],decls:1,vars:1,consts:[[3,"formGroup","submit",4,"ngIf"],[3,"submit","formGroup"],[4,"cxFeature"],[1,"cx-import-entries-subtitle"],[3,"update","formControl","accept"],["prefix","formErrors.file",3,"control"],[1,"cx-import-entries-row"],[1,"cx-import-entries-label","label-content"],["formControlName","name","required","","type","text",1,"form-control",3,"maxLength"],["id","nameError",3,"control"],[1,"cx-import-entries-label-optional"],["formControlName","description","rows","5",1,"form-control",3,"maxLength"],["id","descriptionError",3,"control"],[1,"cx-import-entries-input-hint"],[1,"cx-import-entries-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],["aria-live","assertive","aria-atomic","true"],[3,"text","type","isVisibleCloseButton","cxFocus",4,"ngIf"],[3,"text","type","isVisibleCloseButton","cxFocus"]],template:function(i,n){i&1&&x(0,Qt,43,44,"form",0),i&2&&o("ngIf",n.form)},dependencies:[F,ve,tt,xe,ge,nt,Ce,Ee,it,Se,ne,re,te,De,Ie,X,V],encapsulation:2,changeDetection:0})}}return t})(),ai=(()=>{class t{constructor(e){this.launchDialogService=e,this.iconTypes=ye,this.focusConfig={trap:!0,block:!0,autofocus:"button",focusOnEscape:!0},this.formState=!0,this.summary$=new Oe({loading:!1,cartName:"",count:0,total:0,successesCount:0,warningMessages:[],errorMessages:[]}),this.context$=this.launchDialogService.data$.pipe(k(i=>i.orderEntriesContext))}isNewCartForm(e){return e.type===M.NEW_SAVED_CART}close(e){this.launchDialogService.closeDialog(e)}importProducts(e,{products:i,savedCartInfo:n}){this.formState=!1,this.summary$.next(O($({},this.summary$.value),{loading:!0,total:i.length,cartName:n?.name})),e.addEntries(i,n).pipe(Be(()=>{this.summary$.next(O($({},this.summary$.value),{loading:!1}))})).subscribe(a=>{this.populateSummary(a)})}populateSummary(e){e.statusCode===we.SUCCESS?this.summary$.next(O($({},this.summary$.value),{count:this.summary$.value.count+1,successesCount:this.summary$.value.successesCount+1})):e.statusCode===we.LOW_STOCK?this.summary$.next(O($({},this.summary$.value),{count:this.summary$.value.count+1,warningMessages:[...this.summary$.value.warningMessages,e]})):this.summary$.next(O($({},this.summary$.value),{count:this.summary$.value.count+1,errorMessages:[...this.summary$.value.errorMessages,e]}))}static{this.\u0275fac=function(i){return new(i||t)(g(q))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-import-entries-dialog"]],standalone:!1,decls:14,vars:16,consts:[["importSummary",""],["reducedForm",""],["role","dialog","aria-labelledby","dialogTitle",1,"modal-dialog","modal-dialog-centered","cx-import-entries-dialog",3,"esc","cxFocus"],[1,"modal-content","cx-import-entries-container"],[1,"modal-header","cx-import-entries-header"],["id","dialogTitle","class","cx-import-entries-title modal-title",4,"cxFeature"],["type","button",1,"cx-import-entries-close","close",3,"click","title","disabled"],["aria-hidden","true"],[3,"type"],[4,"ngIf"],["id","dialogTitle",1,"cx-import-entries-title","modal-title"],[4,"ngIf","ngIfElse"],["class","modal-body",3,"type","submitEvent",4,"ngIf","ngIfElse"],[1,"modal-body",3,"submitEvent","type"],[1,"modal-body",3,"closeEvent","summary","type"]],template:function(i,n){if(i&1&&(s(0,"div",2),v("esc",function(){return n.close("Escape clicked")}),s(1,"div",3)(2,"div",4),b(3),x(4,Wt,3,3,"h3",5)(5,Yt,3,3,"div",5),w(),s(6,"button",6),l(7,"cxTranslate"),l(8,"async"),l(9,"cxTranslate"),v("click",function(){return n.close("Close Import Products Dialog")}),s(10,"span",7),_(11,"cx-icon",8),p()()(),x(12,ei,4,2,"ng-container",9),l(13,"async"),p()()),i&2){let a;o("cxFocus",n.focusConfig),r(4),o("cxFeature","a11yDialogsHeading"),r(),o("cxFeature","!a11yDialogsHeading"),r(),Ae("title",m(7,8,"importEntriesDialog.close")),o("disabled",(a=m(8,10,n.summary$))==null?null:a.loading),Q("aria-label",m(9,12,"importEntriesDialog.close")),r(5),o("type",n.iconTypes.CLOSE),r(),o("ngIf",m(13,14,n.context$))}},dependencies:[F,he,te,X,yt,ri,oi,A,V],encapsulation:2,changeDetection:0})}}return t})(),si={launch:{IMPORT_TO_CART:{inlineRoot:!0,component:ai,dialogType:st.DIALOG}}},Ne=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=T({type:t})}static{this.\u0275inj=S({providers:[K(si)],imports:[Y,rt,ot,mt,ne,re,pt,at,dt,ee,ct,ue,J.withConfig({cmsComponents:{ImportOrderEntriesComponent:{component:Ct}}}),ue]})}}return t})(),pi=(()=>{class t{constructor(e){this.contextService=e,this.context$=this.contextService.get(ae),this.shouldDisplayImport$=this.context$.pipe(k(i=>!!i?.addEntries)),this.shouldDisplayExport$=this.context$.pipe(z(i=>i?.getEntries?.()??B([])),k(i=>!!i?.length))}static{this.\u0275fac=function(i){return new(i||t)(g(oe))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-import-export-order-entries"]],standalone:!1,decls:4,vars:6,consts:[[4,"ngIf"]],template:function(i,n){i&1&&(x(0,ti,1,0,"cx-import-order-entries",0),l(1,"async"),x(2,ii,1,0,"cx-export-order-entries",0),l(3,"async")),i&2&&(o("ngIf",m(1,2,n.shouldDisplayImport$)),r(2),o("ngIf",m(3,4,n.shouldDisplayExport$)))},dependencies:[Ct,vt,F,A],encapsulation:2,changeDetection:0})}}return t})(),ht=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=T({type:t})}static{this.\u0275inj=S({imports:[lt,J.withConfig({cmsComponents:{ImportExportOrderEntriesComponent:{component:pi}}}),ee,fe,Ne,Me,Y]})}}return t})();var Ri=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=T({type:t})}static{this.\u0275inj=S({imports:[gt.forRoot(),Me,Ne,ht]})}}return t})();export{Ri as ImportExportModule};
