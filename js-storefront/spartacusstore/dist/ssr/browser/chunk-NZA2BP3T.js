import{H as tt,c as Z}from"./chunk-EU5ZHKTW.js";import{X as H,Z as J,_ as K}from"./chunk-H2QHHFZD.js";import{$b as n,Ad as $,Bb as D,Cc as L,Cd as k,Dg as Y,Eg as z,He as N,Ic as R,Kd as U,Lb as h,Nb as g,Oe as O,Pa as u,Q as M,Rf as V,Tb as q,Ub as o,Wa as F,Ya as P,Za as B,ac as p,bb as _,bc as s,ca as C,da as v,fa as x,hb as A,ib as m,ig as W,ma as I,n as d,na as T,pa as a,q as r,r as S,rg as G,sb as l,sf as Q,sg as X,tb as f,te as b,ub as j,xc as E,ye as w}from"./chunk-PRP3ZKGZ.js";import"./chunk-25N2FLV6.js";var rt=t=>({quantity:t}),y=t=>({count:t}),at=()=>({cxRoute:"cart"}),ot=t=>({total:t});function ct(t,et){if(t&1&&(l(0,"a",1),n(1,"cxTranslate"),n(2,"cxUrl"),n(3,"cxTranslate"),j(4,"cx-icon",2),l(5,"span",3),h(6),n(7,"async"),n(8,"cxTranslate"),f(),l(9,"span",4),h(10),n(11,"async"),n(12,"cxTranslate"),f()()),t&2){let e=et.ngIf,i=D();m("title",s(1,6,"miniCart.item",o(24,y,e.quantity)))("routerLink",p(2,9,q(26,at))),A("aria-label",s(3,11,"miniCart.item",o(27,y,e.quantity))),u(4),m("type",i.iconTypes.CART),u(2),g(" ",s(8,16,"miniCart.total",o(29,ot,p(7,14,i.total$)))," "),u(4),g(" ",s(12,21,"miniCart.count",o(31,y,p(11,19,i.quantity$)))," ")}}var pt=(()=>{class t{constructor(e,i,c,it,nt){this.activeCartFacade=e,this.authService=i,this.statePersistenceService=c,this.siteContextParamsService=it,this.eventService=nt}getQuantity(){return this.activeCartRequired().pipe(v(e=>e?this.activeCartFacade.getActive().pipe(C({totalUnitCount:0}),r(i=>i.totalUnitCount||0)):d(0)))}getTotalPrice(){return this.activeCartRequired().pipe(v(e=>e?this.activeCartFacade.getActive().pipe(r(i=>i.totalPrice?.formattedValue??"")):d("")))}activeCartRequired(){return S([this.hasActiveCartInStorage(),this.authService.isUserLoggedIn(),this.isCartCreated()]).pipe(r(([e,i,c])=>e||i||c),M(),x(e=>!e,!0))}hasActiveCartInStorage(){return this.getCartStateFromBrowserStorage().pipe(r(e=>!!e?.active))}isCartCreated(){return this.eventService.get(Z).pipe(r(e=>!0),C(!1))}getCartStateFromBrowserStorage(){return this.siteContextParamsService.getValues([b]).pipe(r(e=>this.statePersistenceService.readStateFromStorage({key:"cart",context:e,storageType:N.LOCAL_STORAGE})))}static{this.\u0275fac=function(i){return new(i||t)(a(tt),a(w),a(Q),a(W),a(O))}}static{this.\u0275prov=I({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),st=(()=>{class t{constructor(e){this.miniCartComponentService=e,this.iconTypes=H,this.quantity$=this.miniCartComponentService.getQuantity(),this.total$=this.miniCartComponentService.getTotalPrice(),V("a11yMiniCartFocusOnMobile")}static{this.\u0275fac=function(i){return new(i||t)(F(pt))}}static{this.\u0275cmp=P({type:t,selectors:[["cx-mini-cart"]],standalone:!1,decls:2,vars:5,consts:[[3,"title","routerLink",4,"ngIf"],[3,"title","routerLink"],[3,"type"],[1,"total"],[1,"count"]],template:function(i,c){i&1&&(_(0,ct,13,33,"a",0),n(1,"async")),i&2&&m("ngIf",o(3,rt,p(1,1,c.quantity$)))},dependencies:[E,$,J,L,G,Y],encapsulation:2,changeDetection:0})}}return t})(),It=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=B({type:t})}static{this.\u0275inj=T({providers:[U({cmsComponents:{MiniCartComponent:{component:st}}})],imports:[R,k,X,K,z]})}}return t})();export{st as MiniCartComponent,pt as MiniCartComponentService,It as MiniCartModule};
