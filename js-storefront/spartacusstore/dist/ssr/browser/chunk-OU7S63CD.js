import{c as N}from"./chunk-HK5WZGTQ.js";import{c as Zt}from"./chunk-MOKI6WPS.js";import{a as T,b as $,e as j,i as ee,j as ie}from"./chunk-VVCV3FQN.js";import"./chunk-MTN5X6Q6.js";import{C as te,R as U}from"./chunk-EU5ZHKTW.js";import{Da as Qt,Ea as qt,Ra as Jt,Ub as Xt,Vb as M,aa as Vt,ja as Gt,ka as Yt,lb as Kt,wa as zt}from"./chunk-H2QHHFZD.js";import{$b as p,Ab as nt,Ad as Ot,Bb as m,Ca as Ct,Cc as Mt,Cd as Ut,D as C,Df as Bt,Dg as ut,Eg as Pt,I as D,Ic as Ft,J as xt,Kb as Wt,Kd as $t,Lb as u,M as Lt,Mb as Tt,Nb as _,Ob as rt,Pa as o,Q as Y,Qf as Ht,Sb as wt,Ub as ot,Ud as W,Wa as X,Wd as jt,Ya as Z,Za as y,_d as pt,ac as d,bb as f,da as g,ec as st,ga as z,gd as lt,hd as At,he as Nt,i as _t,ia as Q,ib as l,m as b,ma as q,na as v,nd as E,od as bt,oe as dt,pa as x,pd as S,q as L,qa as vt,qd as Dt,r as gt,rf as O,rg as kt,sb as c,sg as Rt,tb as a,ua as yt,ub as Et,va as J,vb as tt,ve as mt,wa as K,wb as et,wc as at,xb as St,xc as ct,yb as it}from"./chunk-PRP3ZKGZ.js";import"./chunk-25N2FLV6.js";var me=["cx-wish-list-item",""],re=t=>({cxRoute:"product",params:t});function ue(t,r){if(t&1&&(c(0,"div",13)(1,"a",14),p(2,"cxUrl"),u(3),a()()),t&2){let e=m();o(),l("routerLink",d(2,2,ot(4,re,e.cartEntry.product))),o(2),Tt(e.cartEntry.product==null?null:e.cartEntry.product.name)}}function he(t,r){if(t&1&&(c(0,"div",15),u(1),p(2,"cxTranslate"),a()),t&2){let e=m();o(),rt(" ",d(2,2,"cartItems.id")," ",e.cartEntry.product==null?null:e.cartEntry.product.code," ")}}function fe(t,r){if(t&1&&(c(0,"div",19),u(1),a()),t&2){let e=m().$implicit;o(),rt(" ",e.name,": ",e.value," ")}}function Ie(t,r){if(t&1&&(c(0,"div",17),f(1,fe,2,2,"div",18),a()),t&2){let e=r.$implicit;o(),l("ngIf",e.name&&e.value)}}function _e(t,r){if(t&1&&(tt(0),f(1,Ie,2,1,"div",16),et()),t&2){let e=m();o(),l("ngForOf",e.cartEntry.product==null||e.cartEntry.product.baseOptions[0]==null||e.cartEntry.product.baseOptions[0].selected==null?null:e.cartEntry.product.baseOptions[0].selected.variantOptionQualifiers)}}function ge(t,r){if(t&1&&(c(0,"div",23),u(1),a()),t&2){let e=m(2);o(),_(" ",e.cartEntry.basePrice==null?null:e.cartEntry.basePrice.formattedValue," ")}}function xe(t,r){if(t&1&&(c(0,"td",20)(1,"div",21),u(2),p(3,"cxTranslate"),a(),f(4,ge,2,1,"div",22),a()),t&2){let e=m();o(2),_(" ",d(3,2,"cartItems.itemPrice")," "),o(2),l("ngIf",e.cartEntry.basePrice)}}function Le(t,r){t&1&&St(0,24)}function ve(t,r){t&1&&(c(0,"span",25),u(1),p(2,"cxTranslate"),a()),t&2&&(o(),_(" ",d(2,1,"addToCart.outOfStock")," "))}function ye(t,r){if(t&1){let e=it();c(0,"button",26),p(1,"cxTranslate"),nt("click",function(){J(e);let n=m();return K(n.removeEntry(n.cartEntry))}),u(2),p(3,"cxTranslate"),a()}if(t&2){let e=m();l("cxAtMessage",d(1,3,"wishlist.itemRemoved"))("disabled",e.isLoading),o(2),_(" ",d(3,5,"common.remove")," ")}}function Ce(t,r){if(t&1){let e=it();c(0,"tr",11),p(1,"async"),nt("remove",function(n){J(e);let w=m(3);return K(w.removeEntry(n))}),a()}if(t&2){let e=r.$implicit,i=m(3);l("cartEntry",e)("isLoading",d(1,2,i.loading$))}}function Ee(t,r){if(t&1&&(c(0,"table",3)(1,"caption",4),u(2),p(3,"cxTranslate"),a(),c(4,"thead")(5,"tr",5)(6,"th",6),u(7),p(8,"cxTranslate"),a(),c(9,"th",7),u(10),p(11,"cxTranslate"),a(),c(12,"th",8),u(13),p(14,"cxTranslate"),a()()(),c(15,"tbody",9),f(16,Ce,2,4,"tr",10),a()()),t&2){let e=m().ngIf;o(2),_(" ",d(3,5,"wishlist.caption")," "),o(5),_(" ",d(8,7,"cartItems.description")," "),o(3),_(" ",d(11,9,"cartItems.itemPrice")," "),o(3),_(" ",d(14,11,"cartItems.actions")," "),o(3),l("ngForOf",e==null?null:e.entries)}}function Se(t,r){if(t&1&&(tt(0),f(1,Ee,17,13,"table",2),et()),t&2){let e=r.ngIf;m();let i=Wt(3);o(),l("ngIf",(e==null||e.entries==null?null:e.entries.length)>0)("ngIfElse",i)}}function We(t,r){t&1&&(c(0,"p",12),u(1),p(2,"cxTranslate"),a()),t&2&&(o(),_(" ",d(2,1,"wishlist.empty")," "))}var Te=(()=>{class t{constructor(e){this.productListItemContextSource=e,this.isLoading=!1,this.remove=new Ct}ngOnChanges(e){e?.cartEntry&&this.productListItemContextSource.product$.next(this.cartEntry.product)}removeEntry(e){this.remove.emit(e)}static{this.\u0275fac=function(i){return new(i||t)(X(M))}}static{this.\u0275cmp=Z({type:t,selectors:[["","cx-wish-list-item",""],["cx-wish-list-item"]],inputs:{isLoading:"isLoading",cartEntry:"cartEntry"},outputs:{remove:"remove"},standalone:!1,features:[wt([M,{provide:Xt,useExisting:M}]),yt],attrs:me,decls:15,vars:12,consts:[["outOfStock",""],["role","cell"],[1,"cx-table-item-container"],["tabindex","-1",3,"routerLink"],["format","thumbnail",3,"container"],[1,"cx-info"],["class","cx-name",4,"ngIf"],["class","cx-code",4,"ngIf"],[4,"ngIf"],["role","cell","class","cx-price",4,"ngIf"],["role","cell",1,"cx-actions"],["cxInnerComponentsHost","",4,"ngIf"],["class","link cx-action-link cx-remove-btn",3,"cxAtMessage","disabled","click",4,"ngIf"],[1,"cx-name"],[1,"cx-link",3,"routerLink"],[1,"cx-code"],["class","cx-property",4,"ngFor","ngForOf"],[1,"cx-property"],["class","cx-label",4,"ngIf"],[1,"cx-label"],["role","cell",1,"cx-price"],[1,"cx-mobile-header"],["class","cx-value",4,"ngIf"],[1,"cx-value"],["cxInnerComponentsHost",""],[1,"cx-out-of-stock"],[1,"link","cx-action-link","cx-remove-btn",3,"click","cxAtMessage","disabled"]],template:function(i,n){i&1&&(c(0,"td",1)(1,"div",2)(2,"a",3),p(3,"cxUrl"),Et(4,"cx-media",4),a(),c(5,"div",5),f(6,ue,4,6,"div",6)(7,he,3,4,"div",7),a()(),f(8,_e,2,1,"ng-container",8),a(),f(9,xe,5,4,"td",9),c(10,"td",10),f(11,Le,1,0,"ng-container",11)(12,ve,3,3,"ng-template",null,0,st)(14,ye,4,7,"button",12),a()),i&2&&(o(2),l("routerLink",d(3,8,ot(10,re,n.cartEntry.product))),o(2),l("container",n.cartEntry.product==null||n.cartEntry.product.images==null?null:n.cartEntry.product.images.PRIMARY),o(2),l("ngIf",n.cartEntry.product==null?null:n.cartEntry.product.name),o(),l("ngIf",n.cartEntry.product==null?null:n.cartEntry.product.code),o(),l("ngIf",n.cartEntry.product==null||n.cartEntry.product.baseOptions==null?null:n.cartEntry.product.baseOptions.length),o(),l("ngIf",n.cartEntry.basePrice),o(2),l("ngIf",n.cartEntry.updateable),o(3),l("ngIf",n.cartEntry.updateable))},dependencies:[Vt,at,ct,Qt,Gt,Ot,ut,kt],encapsulation:2,changeDetection:0})}}return t})(),we=(()=>{class t{constructor(e){this.wishListFacade=e,this.wishList$=this.wishListFacade.getWishList(),this.loading$=this.wishListFacade.getWishListLoading()}removeEntry(e){this.wishListFacade.removeEntry(e)}static{this.\u0275fac=function(i){return new(i||t)(X(N))}}static{this.\u0275cmp=Z({type:t,selectors:[["cx-wish-list"]],standalone:!1,decls:4,vars:3,consts:[["emptyWishList",""],[4,"ngIf"],["role","table",4,"ngIf","ngIfElse"],["role","table"],[1,"cx-visually-hidden"],["role","row",1,"cx-item-list-header","cx-wish-list-header"],["role","columnheader",1,"cx-item-list-desc"],["role","columnheader",1,"cx-item-list-price"],["role","columnheader",1,"cx-item-list-actions"],[1,"cx-item-list-items"],["cx-wish-list-item","","role","row","class","cx-item-list-row cx-wish-list-item-row",3,"cartEntry","isLoading","remove",4,"ngFor","ngForOf"],["cx-wish-list-item","","role","row",1,"cx-item-list-row","cx-wish-list-item-row",3,"remove","cartEntry","isLoading"],[1,"cx-empty-wish-list"]],template:function(i,n){i&1&&(f(0,Se,2,2,"ng-container",1),p(1,"async"),f(2,We,3,3,"ng-template",null,0,st)),i&2&&l("ngIf",d(1,1,n.wishList$))},dependencies:[at,ct,Te,Mt,ut],encapsulation:2})}}return t})(),oe=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=y({type:t})}static{this.\u0275inj=v({providers:[$t({cmsComponents:{WishListComponent:{component:we,data:{composition:{inner:["ProductAddToCartComponent"]}},guards:[Bt]}}})],imports:[zt,Ft,Pt,Jt,qt,Yt,Ut,Kt,Rt,Ht]})}}return t})();var ae="[Wish List] Create Wish List",Me="[Wish List] Create Wish List Fail",F="[Wish List] Create Wish List Success",ce="[Wish List] Load Wish List",A="[Wish List] Load Wish List Success",Fe="[Wish List] Load Wish List Fail",B=class{constructor(r){this.payload=r,this.type=ae}},ht=class extends W.EntitySuccessAction{constructor(r){super(T,r.cartId),this.payload=r,this.type=F}},ft=class extends W.EntityFailAction{constructor(r){super(T,r.cartId,r.error),this.payload=r,this.type=Me}},It=class extends W.EntityLoadAction{constructor(r){super(T,r.cartId),this.payload=r,this.type=ce}},H=class extends W.EntitySuccessAction{constructor(r){super(T,r.cartId),this.payload=r,this.type=A}},k=class extends W.EntityFailAction{constructor(r){super(T,r.cartId,r.error),this.payload=r,this.type=Fe}};function Ae(t){return`wishlist${t}`}var se=(()=>{class t{constructor(e,i,n,w){this.store=e,this.userAccountFacade=i,this.multiCartFacade=n,this.userIdService=w}createWishList(e,i,n){this.store.dispatch(new B({userId:e,name:i,description:n}))}getWishList(){return gt([this.getWishListId(),this.userAccountFacade.get(),this.userIdService.getUserId()]).pipe(Y(),z(([e,i,n])=>{!e&&n!==jt&&i?.customerId&&this.loadWishList(n,i.customerId)}),C(([e])=>!!e),g(([e])=>this.multiCartFacade.getCart(e)))}loadWishList(e,i){this.store.dispatch(new It({userId:e,cartId:Ae(i)}))}addEntry(e){this.getWishListIdWithUserId().subscribe(([i,n])=>this.multiCartFacade.addEntry(n,i,e,1))}removeEntry(e){this.getWishListIdWithUserId().subscribe(([i,n])=>this.multiCartFacade.removeEntry(n,i,e.entryNumber))}getWishListLoading(){return this.getWishListId().pipe(g(e=>this.multiCartFacade.isStable(e).pipe(L(i=>!i))))}getWishListId(){return this.multiCartFacade.getCartIdByType(U.WISH_LIST)}getWishListIdWithUserId(){return this.getWishListId().pipe(Y(),Q(this.userIdService.getUserId(),this.userAccountFacade.get()),z(([e,i,n])=>{!e&&n?.customerId&&this.loadWishList(i,n.customerId)}),C(([e])=>!!e),L(([e,i])=>[e,i]),Lt(1))}static{this.\u0275fac=function(i){return new(i||t)(x(lt),x(Zt),x(te),x(pt))}}static{this.\u0275prov=q({token:t,factory:t.\u0275fac})}}return t})(),be=[se,{provide:N,useExisting:se}],De=(()=>{class t{constructor(e,i,n,w){this.actions$=e,this.cartConnector=i,this.userIdService=n,this.store=w,this.logger=vt(Nt),this.createWishList$=E(()=>this.actions$.pipe(S(ae),L(s=>s.payload),g(s=>this.cartConnector.create(s.userId).pipe(g(I=>this.cartConnector.save(s.userId,I.code??"",s.name,s.description).pipe(g(h=>[new ht({cart:h,cartId:j(h,s.userId)})]),D(h=>b([new ft({cartId:I.code??"",error:O(h,this.logger)})])))))))),this.loadWishList$=E(()=>this.actions$.pipe(S(ce),L(s=>s.payload),xt(s=>{let{userId:I,cartId:h}=s;return this.cartConnector.loadAll(I).pipe(g(R=>{let P=h,V=R.find(pe=>pe.name===P),G=[];return G.push(V?new H({cart:V,cartId:j(V,I)}):new B({userId:I,name:P})),G.push(new $.RemoveCart({cartId:P})),G}),D(R=>b([new k({cartId:h,error:O(R,this.logger)})])))}))),this.resetWishList$=E(()=>this.actions$.pipe(S(mt.LANGUAGE_CHANGE,mt.CURRENCY_CHANGE),Q(this.userIdService.getUserId(),this.store.pipe(C(s=>!!s.cart),At(ie.getCartIdByTypeFactory(U.WISH_LIST)))),g(([,s,I])=>I?this.cartConnector.load(s,I).pipe(g(h=>[new H({cart:h??{},cartId:j(h,s)})]),D(h=>b([new k({cartId:I,error:O(h,this.logger)})]))):_t))),this.setWishListId$=E(()=>this.actions$.pipe(S(F,A),L(s=>{switch(s.type){case F:case A:return new $.SetCartTypeIndex({cartType:U.WISH_LIST,cartId:s.meta.entityId})}}),C(dt))),this.setWishListData$=E(()=>this.actions$.pipe(S(F,A),L(s=>{switch(s.type){case F:case A:return new $.SetCartData({cart:s.payload.cart,cartId:s.payload.cartId})}}),C(dt)))}static{this.\u0275fac=function(i){return new(i||t)(x(bt),x(ee),x(pt),x(lt))}}static{this.\u0275prov=q({token:t,factory:t.\u0275fac})}}return t})(),Oe=[De],Ue=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=y({type:t})}static{this.\u0275inj=v({imports:[Dt.forFeature(Oe)]})}}return t})(),le=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=y({type:t})}static{this.\u0275inj=v({providers:[...be],imports:[Ue]})}}return t})();var Ii=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=y({type:t})}static{this.\u0275inj=v({imports:[oe,le]})}}return t})();export{Ii as WishListModule};
