import{a as It,c as Q,d as Qt}from"./chunk-PFZ352WB.js";import{H as Z,T as Et,U as V,g as pe,h as St}from"./chunk-EU5ZHKTW.js";import{A as ft,C as Pe,Da as Be,Ea as Ot,Ha as bt,Ia as Ae,Oa as le,Pa as ue,Qa as qt,Ra as Ft,X as gt,Z as xt,_ as ht,b as Te,ba as yt,c as we,cb as Tt,d as Se,db as wt,e as Ee,fa as kt,g as pt,j as de,l as Ie,m as mt,p as Qe,s as Me,w as _t,wa as Ct,xa as vt}from"./chunk-H2QHHFZD.js";import{$b as a,Ab as F,Ad as et,Af as Oe,B as Ge,Bb as s,Bc as Je,Cc as ce,Cd as Ce,D as $,Dg as j,Eb as re,Eg as Fe,Fc as Ze,Gd as ae,Hb as _e,He as ot,I as Ye,Ib as fe,Ic as ke,Ja as ie,Jb as ge,Kb as H,Kd as ve,L as We,Lb as _,Lf as be,M as R,Mb as K,Mf as X,Nb as h,Ob as xe,Oe as se,Pa as n,Pg as lt,Q as Ue,Qd as tt,Qf as qe,Qg as ut,Rf as J,Ub as O,V as G,Vb as ne,Wa as q,Wb as Ke,Ya as D,Za as A,a as I,ac as l,bb as m,bc as b,c as De,d as E,da as Y,ec as he,ee as it,fc as ze,ga as W,gc as ye,hb as w,he as rt,ib as c,ig as at,kb as L,ma as U,mb as He,n as M,na as B,pa as S,q as P,qa as te,r as Le,rg as st,sb as u,sf as ct,sg as dt,t as Ne,tb as p,te as nt,ub as k,uc as Xe,va as f,vb as C,wa as g,wb as v,wc as oe,xc as z,yb as T,z as je,zf as N}from"./chunk-PRP3ZKGZ.js";import"./chunk-25N2FLV6.js";var Mt=(()=>{class t{constructor(e,i,r,o){this.activeCartService=e,this.config=i,this.eventService=r,this.productSearchConnector=o,this.productAdded$=new De,this.entries$=new E([]),this.softDeletedEntries$=new E({}),this.nonPurchasableProductError$=new E(null),this.hardDeleteTimeout=this.config.quickOrder?.list?.hardDeleteTimeout||7e3,this.quickOrderListLimit=0,this.clearDeleteTimeouts={}}ngOnDestroy(){this.clearDeletedEntries()}getEntries(){return this.entries$}searchProducts(e,i){if(this.productSearchConnector){let r={pageSize:i||It.quickOrder?.searchForm?.maxProducts};return this.productSearchConnector.search(e,r).pipe(P(o=>o.products||[]))}else return M([])}clearList(){this.entries$.next([])}canAdd(e,i){return e&&i?M(this.isProductOnTheList(e)||!this.isLimitExceeded(e,i)):e?M(this.isProductOnTheList(e)||!this.isLimitExceeded()):M(!this.isLimitExceeded())}setListLimit(e){this.quickOrderListLimit=e}loadEntries(e=[]){this.entries$.next(e)}updateEntryQuantity(e,i){let r=this.entries$.getValue()||[];r[e].quantity=i,this.entries$.next(r)}softDeleteEntry(e){this.entries$.pipe(R(1)).subscribe(i=>{let r=i;this.addSoftEntryDeletion(r[e],!0),r.splice(e,1),this.entries$.next(r)})}addProduct(e,i=1){let r=this.generateOrderEntry(e,i);this.addEntry(r)}getProductAdded(){return this.productAdded$}setProductAdded(e){this.productAdded$.next(e)}addToCart(){let e=[],i=[],r=this.eventService.get(pe).subscribe(o=>{(o.quantityAdded===0||o.quantityAdded&&o.quantityAdded<o.quantity)&&i.push(this.createQuickOrderResultEvent(o))});return r.add(this.eventService.get(St).subscribe(o=>{i.push(this.createQuickOrderResultEvent(o))})),this.getEntries().pipe(G(),Y(o=>(e=o,this.activeCartService.addEntries(o),this.clearList(),this.activeCartService.isStable())),$(o=>o),P(()=>[e,i]),W(()=>r.unsubscribe()))}getSoftDeletedEntries(){return this.softDeletedEntries$}restoreSoftDeletedEntry(e){let i=this.getSoftDeletedEntry(e);this.addEntry(i),this.hardDeleteEntry(e)}hardDeleteEntry(e){let i=this.getSoftDeletedEntry(e),r=this.softDeletedEntries$.getValue();i&&(delete r[e],this.softDeletedEntries$.next(r)),this.clearDeleteTimeout(e)}clearDeletedEntries(){Object.values(this.clearDeleteTimeouts).forEach(e=>e.unsubscribe()),this.softDeletedEntries$.next({}),this.clearDeleteTimeouts={}}getNonPurchasableProductError(){return this.nonPurchasableProductError$}setNonPurchasableProductError(e){this.nonPurchasableProductError$.next(e)}clearNonPurchasableProductError(){this.nonPurchasableProductError$.next(null)}addSoftEntryDeletion(e,i=!0){let r=this.softDeletedEntries$.getValue(),o=e?.product?.code;if(o&&(r[o]=e,this.softDeletedEntries$.next(r),i)){let x=je(this.hardDeleteTimeout).subscribe(()=>{this.hardDeleteEntry(o)});this.clearDeleteTimeouts[o]=x}}getSoftDeletedEntry(e){return this.softDeletedEntries$.getValue()[e]}generateOrderEntry(e,i){return{basePrice:e.price,product:e,quantity:i,totalPrice:e.price}}addEntry(e){if(e?.product?.code&&!this.isProductOnTheList(e.product.code)&&this.isLimitExceeded())return;let i=this.entries$.getValue()||[],r=e.product?.stock?.stockLevel;if(r&&e.quantity&&e.quantity>r&&(e.quantity=r),e.product?.code&&this.isProductOnTheList(e.product.code)){let o=i.findIndex(y=>y.product?.code===e.product?.code),x=i[o].quantity;if(x&&e.quantity){i[o].quantity=x+e?.quantity;let y=i[o].quantity;y&&r&&y>r&&(i[o].quantity=r),this.entries$.next([...i])}}else this.entries$.next([...i,e]);this.productAdded$.next(e.product?.code)}isProductOnTheList(e){return!!(this.entries$.getValue()||[]).find(r=>r.product?.code===e)}isLimitExceeded(e,i){let r=this.entries$.getValue()||[],o=e&&i?this.getMissingProductIndex(r,e,i):0;return r.length+(o||0)>=this.quickOrderListLimit}getMissingProductIndex(e,i,r){return(r?.filter(x=>!e.map(y=>y.product?.code).includes(x.productCode))||[]).findIndex(x=>x.productCode===i)}createQuickOrderResultEvent(e){let i={productCode:e.productCode,quantity:e.quantity};if("entry"in e&&(i.entry=e.entry),"quantityAdded"in e&&(i.quantityAdded=e.quantityAdded),"error"in e&&e.error instanceof tt&&(i.error=e.error),i.error?.details?.length){let r=i.error?.details.some(o=>o.type==="InsufficientStockError");i.quantityAdded=r?0:i.quantity}return i}clearDeleteTimeout(e){let i=this.clearDeleteTimeouts[e];i&&(i.unsubscribe(),delete this.clearDeleteTimeouts[e])}static{this.\u0275fac=function(i){return new(i||t)(S(Z),S(ae),S(se),S(ut))}}static{this.\u0275prov=U({token:t,factory:t.\u0275fac})}}return t})(),Yt=[Mt,{provide:Q,useExisting:Mt}],Ve=(()=>{class t{constructor(e,i,r){this.quickOrderService=e,this.siteContextParamsService=i,this.statePersistenceService=r,this.subscription=new I,this.key="quick-order"}initSync(){this.subscription.add(this.statePersistenceService.syncWithStorage({key:this.key,state$:this.quickOrderService.getEntries(),context$:this.siteContextParamsService.getValues([nt]),storageType:ot.SESSION_STORAGE,onRead:e=>this.onRead(e)}))}onRead(e){e&&this.quickOrderService.loadEntries(e)}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(i){return new(i||t)(S(Q),S(at),S(ct))}}static{this.\u0275prov=U({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),Bt=(()=>{class t{static forRoot(){return{ngModule:t}}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=A({type:t})}static{this.\u0275inj=B({providers:[...Yt,Ve]})}}return t})();var Vt=t=>({label:t});function Ut(t,d){t&1&&(C(0),k(1,"cx-form-required-legend"),v())}function Ht(t,d){}function Kt(t,d){t&1&&(C(0),k(1,"input",12),a(2,"cxTranslate"),a(3,"cxTranslate"),v()),t&2&&(n(),re("placeholder",l(2,2,"quickOrderCartForm.productCodePlaceholder")),w("aria-label",l(3,4,"quickOrderCartForm.entryProductCode")))}function zt(t,d){t&1&&(C(0),k(1,"input",13),a(2,"cxTranslate"),a(3,"cxTranslate"),v()),t&2&&(n(),re("placeholder",l(2,2,"quickOrderCartForm.productCodePlaceholder")),w("aria-label",l(3,4,"quickOrderCartForm.entryProductCode")))}function Xt(t,d){}function Jt(t,d){if(t&1&&(u(0,"label",8),_(1),a(2,"cxTranslate"),m(3,Xt,0,0,"ng-template",9),p()),t&2){s(2);let e=H(3);n(),h(" ",l(2,2,"quickOrderCartForm.quantityFullLabel")," "),n(2),c("ngTemplateOutlet",e)}}function Zt(t,d){}function ei(t,d){if(t&1&&(u(0,"label",8),_(1),a(2,"cxTranslate"),m(3,Zt,0,0,"ng-template",9),p()),t&2){s(2);let e=H(3);n(),h(" ",l(2,2,"quickOrderCartForm.quantityLabel")," "),n(2),c("ngTemplateOutlet",e)}}function ti(t,d){t&1&&(C(0),k(1,"input",14),a(2,"cxTranslate"),v()),t&2&&(n(),w("aria-label",l(2,1,"quickOrderCartForm.quantity")))}function ii(t,d){t&1&&(C(0),k(1,"input",15),a(2,"cxTranslate"),v()),t&2&&(n(),w("aria-label",l(2,1,"quickOrderCartForm.quantity")))}function ri(t,d){if(t&1&&(C(0),u(1,"button",16),a(2,"async"),a(3,"async"),a(4,"cxTranslate"),_(5),a(6,"cxTranslate"),p(),v()),t&2){let e,i=s(2);n(),L("disabled",l(2,5,i.cartIsLoading$)),c("disabled",l(3,7,i.cartIsLoading$)||!(!(i.quickOrderForm==null||(e=i.quickOrderForm.get("productCode"))==null)&&e.value)||!(!(i.quickOrderForm==null||(e=i.quickOrderForm.get("quantity"))==null)&&e.value)),w("aria-label",l(4,9,"quickOrderCartForm.addToCart")),n(4),h(" ",l(6,11,"quickOrderCartForm.add")," ")}}function ni(t,d){if(t&1&&(k(0,"cx-form-errors",19),a(1,"cxTranslate")),t&2){let e=s(3);c("translationParams",O(4,Vt,l(1,2,"quickOrderCartForm.productCodeLabel")))("control",e.quickOrderForm.get("productCode"))}}function oi(t,d){if(t&1&&k(0,"cx-form-errors",20),t&2){let e=s(3);c("control",e.quickOrderForm.get("productCode"))}}function ci(t,d){if(t&1&&(k(0,"cx-form-errors",19),a(1,"cxTranslate")),t&2){let e=s(3);c("translationParams",O(4,Vt,l(1,2,"quickOrderCartForm.quantityFullLabel")))("control",e.quickOrderForm.get("quantity"))}}function ai(t,d){if(t&1&&k(0,"cx-form-errors",20),t&2){let e=s(3);c("control",e.quickOrderForm.get("quantity"))}}function si(t,d){if(t&1&&(C(0),u(1,"button",16),a(2,"async"),a(3,"async"),a(4,"cxTranslate"),_(5),a(6,"cxTranslate"),p(),m(7,ni,2,6,"cx-form-errors",17)(8,oi,1,1,"cx-form-errors",18)(9,ci,2,6,"cx-form-errors",17)(10,ai,1,1,"cx-form-errors",18),v()),t&2){let e=s(2);n(),L("disabled",l(2,9,e.cartIsLoading$)),c("disabled",l(3,11,e.cartIsLoading$)),w("aria-label",l(4,13,"quickOrderCartForm.addToCart")),n(4),h(" ",l(6,15,"quickOrderCartForm.add")," "),n(2),c("cxFeature","formErrorsDescriptiveMessages"),n(),c("cxFeature","!formErrorsDescriptiveMessages"),n(),c("cxFeature","formErrorsDescriptiveMessages"),n(),c("cxFeature","!formErrorsDescriptiveMessages")}}function di(t,d){if(t&1){let e=T();C(0),u(1,"div",2),_(2),a(3,"cxTranslate"),p(),u(4,"div",3)(5,"form",4),F("ngSubmit",function(){f(e);let r=s();return g(r.applyQuickOrder())}),u(6,"div",5),m(7,Ut,2,0,"ng-container",6),u(8,"span",7)(9,"label",8),_(10),a(11,"cxTranslate"),m(12,Ht,0,0,"ng-template",9),p(),m(13,Kt,4,6,"ng-container",6)(14,zt,4,6,"ng-container",6),p(),u(15,"span",10),m(16,Jt,4,4,"label",11)(17,ei,4,4,"label",11)(18,ti,3,3,"ng-container",6)(19,ii,3,3,"ng-container",6),p(),m(20,ri,7,13,"ng-container",6)(21,si,11,17,"ng-container",6),p()()(),v()}if(t&2){let e=s(),i=H(3);n(2),h(" ",l(3,13,"quickOrderCartForm.title")," "),n(3),c("formGroup",e.quickOrderForm),n(2),c("cxFeature","!a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields"),n(3),h(" ",l(11,15,"quickOrderCartForm.productCodeLabel")," "),n(2),c("ngTemplateOutlet",i),n(),c("cxFeature","a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields"),n(),c("cxFeature","!a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields"),n(2),c("cxFeature","a11yQTY2Quantity"),n(),c("cxFeature","!a11yQTY2Quantity"),n(),c("cxFeature","a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields"),n(),c("cxFeature","!a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields"),n(),c("cxFeature","a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields"),n(),c("cxFeature","!a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields")}}function li(t,d){t&1&&(C(0),k(1,"cx-form-required-asterisks"),v())}function ui(t,d){t&1&&m(0,li,2,0,"ng-container",6),t&2&&c("cxFeature","!a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields")}var pi=["quickOrderInput"],$t=t=>({limit:t}),ee=t=>({count:t}),Re=t=>({id:t});function mi(t,d){if(t&1){let e=T();u(0,"button",10),a(1,"cxTranslate"),a(2,"cxTranslate"),F("click",function(r){f(e);let o=s();return g(o.clear(r))})("keydown.enter",function(r){f(e);let o=s();return g(o.clear(r))}),k(3,"cx-icon",11),p()}if(t&2){let e=s();w("aria-label",l(1,3,"common.reset"))("title",l(2,5,"common.reset")),n(3),c("type",e.iconTypes.RESET)}}function _i(t,d){if(t&1&&(u(0,"button",12),a(1,"cxTranslate"),a(2,"cxTranslate"),k(3,"cx-icon",11),p()),t&2){let e=s();w("aria-label",l(1,3,"common.search"))("title",l(2,5,"common.search")),n(3),c("type",e.iconTypes.SEARCH)}}function fi(t,d){t&1&&(u(0,"span",13),_(1),a(2,"cxTranslate"),p()),t&2&&(n(),h(" ",l(2,1,"quickOrderForm.listLimitReached")," "))}function gi(t,d){if(t&1&&k(0,"cx-media",27),t&2){let e=s(2).$implicit;c("alt",e.name)("container",e.images==null?null:e.images.PRIMARY)}}function xi(t,d){if(t&1){let e=T();u(0,"button",22),F("blur",function(r){f(e);let o=s(4);return g(o.onBlur(r))})("mousedown",function(r){f(e);let o=s().$implicit,x=s(3);return g(x.add(o,r))})("keydown.arrowdown",function(r){f(e);let o=s(4);return g(o.focusNextChild(r))})("keydown.arrowup",function(r){f(e);let o=s(4);return g(o.focusPreviousChild(r))})("keydown.enter",function(r){f(e);let o=s().$implicit,x=s(3);return g(x.add(o,r))})("keydown.escape",function(r){f(e);let o=s(4);return g(o.clear(r))}),m(1,gi,1,2,"cx-media",23),k(2,"div",24),u(3,"span",25),_(4),a(5,"cxTranslate"),p(),u(6,"span",26),_(7),p()()}if(t&2){let e=s().$implicit,i=s(3);L("has-media",i.config==null||i.config.quickOrder==null||i.config.quickOrder.searchForm==null?null:i.config.quickOrder.searchForm.displayProductImages),n(),c("ngIf",i.config==null||i.config.quickOrder==null||i.config.quickOrder.searchForm==null?null:i.config.quickOrder.searchForm.displayProductImages),n(),c("innerHTML",e.name,ie),n(2),h(" ",b(5,6,"quickOrderForm.id",O(9,Re,e.code))," "),n(3),K(e.price==null?null:e.price.formattedValue)}}function hi(t,d){if(t&1&&k(0,"cx-media",27),t&2){let e=s(2).$implicit;c("alt",e.name)("container",e.images==null?null:e.images.PRIMARY)}}function yi(t,d){if(t&1){let e=T();u(0,"button",28),F("blur",function(r){f(e);let o=s(4);return g(o.onBlur(r))})("mousedown",function(r){f(e);let o=s().$implicit,x=s(3);return g(x.add(o,r))})("keydown.arrowdown",function(r){f(e);let o=s(4);return g(o.focusNextChild(r))})("keydown.arrowup",function(r){f(e);let o=s(4);return g(o.focusPreviousChild(r))})("keydown.enter",function(r){f(e);let o=s().$implicit,x=s(3);return g(x.add(o,r))})("keydown.escape",function(r){f(e);let o=s(4);return g(o.clear(r))})("keydown.tab",function(){f(e);let r=s(4);return g(r.close())})("keydown.shift.tab",function(){f(e);let r=s(4);return g(r.close())}),m(1,hi,1,2,"cx-media",23),k(2,"div",24),u(3,"span",25),_(4),a(5,"cxTranslate"),p(),u(6,"span",26),_(7),p()()}if(t&2){let e=s().$implicit,i=s(3);L("has-media",i.config==null||i.config.quickOrder==null||i.config.quickOrder.searchForm==null?null:i.config.quickOrder.searchForm.displayProductImages),n(),c("ngIf",i.config==null||i.config.quickOrder==null||i.config.quickOrder.searchForm==null?null:i.config.quickOrder.searchForm.displayProductImages),n(),c("innerHTML",e.name,ie),n(2),h(" ",b(5,6,"quickOrderForm.id",O(9,Re,e.code))," "),n(3),K(e.price==null?null:e.price.formattedValue)}}function ki(t,d){t&1&&(u(0,"li",19),m(1,xi,8,11,"button",20)(2,yi,8,11,"button",21),p()),t&2&&(n(),c("cxFeature","!a11yQuickOrderSearchListKeyboardNavigation"),n(),c("cxFeature","a11yQuickOrderSearchListKeyboardNavigation"))}function Ci(t,d){if(t&1&&(u(0,"ul",17),m(1,ki,3,2,"li",18),p()),t&2){let e=s(2);n(),c("ngForOf",e.results)}}function vi(t,d){t&1&&(u(0,"span",29),_(1),a(2,"cxTranslate"),p()),t&2&&(n(),h(" ",l(2,1,"quickOrderForm.noResults")," "))}function Oi(t,d){if(t&1&&(u(0,"div",14),m(1,Ci,2,1,"ul",15)(2,vi,3,3,"span",16),p()),t&2){let e=s();n(),c("ngIf",e.isResultsBoxOpen()&&e.results.length),n(),c("ngIf",e.noResults)}}function bi(t,d){if(t&1&&k(0,"cx-media",27),t&2){let e=s().$implicit;c("alt",e.name)("container",e.images==null?null:e.images.PRIMARY)}}function qi(t,d){if(t&1){let e=T();u(0,"li",19)(1,"button",22),F("blur",function(r){f(e);let o=s(4);return g(o.onBlur(r))})("mousedown",function(r){let o=f(e).$implicit,x=s(4);return g(x.add(o,r))})("keydown.arrowdown",function(r){f(e);let o=s(4);return g(o.focusNextChild(r))})("keydown.arrowup",function(r){f(e);let o=s(4);return g(o.focusPreviousChild(r))})("keydown.enter",function(r){let o=f(e).$implicit,x=s(4);return g(x.add(o,r))})("keydown.escape",function(r){f(e);let o=s(4);return g(o.clear(r))}),m(2,bi,1,2,"cx-media",23),k(3,"div",24),u(4,"span",25),_(5),a(6,"cxTranslate"),p(),u(7,"span",26),_(8),p()()()}if(t&2){let e=d.$implicit,i=s(4);n(),L("has-media",i.config==null||i.config.quickOrder==null||i.config.quickOrder.searchForm==null?null:i.config.quickOrder.searchForm.displayProductImages),n(),c("ngIf",i.config==null||i.config.quickOrder==null||i.config.quickOrder.searchForm==null?null:i.config.quickOrder.searchForm.displayProductImages),n(),c("innerHTML",e.name,ie),n(2),h(" ",b(6,6,"quickOrderForm.id",O(9,Re,e.code))," "),n(3),K(e.price==null?null:e.price.formattedValue)}}function Fi(t,d){if(t&1&&(u(0,"ul",17),m(1,qi,9,11,"li",18),p()),t&2){let e=s(3);n(),c("ngForOf",e.results)}}function Ti(t,d){t&1&&(u(0,"span",29),_(1),a(2,"cxTranslate"),p()),t&2&&(n(),h(" ",l(2,1,"quickOrderForm.noResults")," "))}function wi(t,d){if(t&1&&(u(0,"div",31),m(1,Fi,2,1,"ul",15)(2,Ti,3,3,"span",16),p()),t&2){let e=s(2);n(),c("ngIf",e.results.length),n(),c("ngIf",e.noResults)}}function Si(t,d){if(t&1&&(C(0),m(1,wi,3,2,"div",30),v()),t&2){let e=s();n(),c("ngIf",e.isResultsBoxOpen())}}var Ei=["cx-quick-order-item",""],Ii=(t,d)=>({disabled:t,"img-missing":d}),At=t=>({cxRoute:"product",params:t}),Qi=t=>({disabled:t});function Mi(t,d){t&1&&(u(0,"div",9),_(1),a(2,"cxTranslate"),p()),t&2&&(n(),h(" ",l(2,1,"quickOrderTable.quantityFull")," "))}function Pi(t,d){t&1&&(u(0,"div",9),_(1),a(2,"cxTranslate"),p()),t&2&&(n(),h(" ",l(2,1,"quickOrderTable.qty")," "))}function Bi(t,d){t&1&&(u(0,"th",10),_(1),a(2,"cxTranslate"),p()),t&2&&(n(),h(" ",l(2,1,"quickOrderTable.quantityFull")," "))}function Ai(t,d){t&1&&(u(0,"th",10),_(1),a(2,"cxTranslate"),p()),t&2&&(n(),h(" ",l(2,1,"quickOrderTable.quantity")," "))}function Vi(t,d){if(t&1&&k(0,"tr",11),t&2){let e=d.$implicit,i=d.index,r=s(2);c("entry",e)("index",i)("loading",r.loading)}}function $i(t,d){if(t&1&&(u(0,"table",1)(1,"caption",2),_(2),a(3,"cxTranslate"),p(),u(4,"thead")(5,"tr",3)(6,"th",4),_(7),a(8,"cxTranslate"),p(),u(9,"th",5),_(10),a(11,"cxTranslate"),p(),m(12,Bi,3,3,"th",6)(13,Ai,3,3,"th",6),u(14,"th",7),_(15),a(16,"cxTranslate"),p()()(),u(17,"tbody",8),m(18,Vi,1,3,"tr",9),p()()),t&2){let e=s();n(2),h(" ",l(3,7,"quickOrderTable.caption")," "),n(5),h(" ",l(8,9,"quickOrderTable.product")," "),n(3),h(" ",l(11,11,"quickOrderTable.price")," "),n(2),c("cxFeature","a11yQTY2Quantity"),n(),c("cxFeature","!a11yQTY2Quantity"),n(2),h(" ",l(16,13,"quickOrderTable.actions")," "),n(3),c("ngForOf",e.entries)}}var Ri=["quickOrderForm"],$e=t=>({name:t}),Rt=(t,d)=>({name:t,code:d}),Di=(t,d,e)=>({name:t,code:d,quantityAdded:e});function Li(t,d){if(t&1&&(C(0),k(1,"cx-message",3),a(2,"cxTranslate"),v()),t&2){let e=s(2).ngIf,i=s();n(),c("text",b(2,3,"quickOrderList.errors.listIsFull",O(6,ee,e.length)))("isVisibleCloseButton",!1)("type",i.globalMessageType.MSG_TYPE_ERROR)}}function Ni(t,d){if(t&1&&(C(0),m(1,Li,3,8,"ng-container",2),v()),t&2){let e,i=s(2);n(),c("ngIf",i.quickOrderForm==null||i.quickOrderForm.form==null||(e=i.quickOrderForm.form.get("product"))==null?null:e.dirty)}}function ji(t,d){if(t&1&&(C(0),m(1,Ni,2,1,"ng-container",2),a(2,"async"),v()),t&2){let e=s();n(),c("ngIf",!l(2,1,e.canAddProduct()))}}function Gi(t,d){if(t&1){let e=T();C(0),u(1,"cx-message",4),a(2,"cxTranslate"),F("closeMessage",function(){f(e);let r=s();return g(r.clearAddToCartInformation())}),p(),v()}if(t&2){let e=s();n(),c("text",l(2,2,"quickOrderList.informations.addProductBeforeAddingToCart"))("type",e.globalMessageType.MSG_TYPE_ERROR)}}function Yi(t,d){if(t&1){let e=T();C(0),u(1,"cx-message",5),a(2,"cxTranslate"),F("closeMessage",function(){f(e);let r=s();return g(r.clearNonPurchasableError())}),p(),v()}if(t&2){let e=d.ngIf,i=s();n(),c("text",b(2,2,"quickOrderList.errors.nonPurchasableError",O(5,$e,e.name)))("type",i.globalMessageType.MSG_TYPE_ERROR)}}function Wi(t,d){if(t&1){let e=T();u(0,"cx-message",7),a(1,"cxTranslate"),a(2,"cxTranslate"),a(3,"cxTranslate"),F("buttonAction",function(){let r=f(e).$implicit,o=s(2);return g(o.undoDeletion(r.value))})("closeMessage",function(){let r=f(e).$implicit,o=s(2);return g(o.clearDeletion(r.value))}),p()}if(t&2){let e=d.$implicit,i=s(2);c("actionButtonText",l(1,4,"quickOrderList.undo"))("actionButtonMessage",b(2,6,"quickOrderList.revokeUndo",O(12,$e,e.value.product==null?null:e.value.product.name)))("text",b(3,9,"quickOrderList.productWasDeleted",O(14,$e,e.value.product==null?null:e.value.product.name)))("type",i.globalMessageType.MSG_TYPE_CONFIRMATION)}}function Ui(t,d){if(t&1&&(C(0),m(1,Wi,4,16,"cx-message",6),a(2,"keyvalue"),v()),t&2){let e=d.ngIf;n(),c("ngForOf",l(2,1,e))}}function Hi(t,d){if(t&1&&(u(0,"li",13)(1,"span"),_(2),a(3,"cxTranslate"),p()()),t&2){let e=d.$implicit;n(2),h(" ",b(3,1,"quickOrderList.errors.productIsOutOfStock",ne(4,Rt,e.entry.product.name,e.entry.product.code))," ")}}function Ki(t,d){if(t&1){let e=T();u(0,"cx-message",9),a(1,"cxTranslate"),a(2,"cxTranslate"),F("closeMessage",function(){f(e);let r=s(2);return g(r.clearErrors())}),u(3,"ul",10),m(4,Hi,4,7,"li",11),p(),u(5,"div",12),_(6),a(7,"cxTranslate"),p()()}if(t&2){let e=s().ngIf,i=s();c("accordionText",l(1,5,"quickOrderList.errors.reviewErrors"))("text",l(2,7,"quickOrderList.errorProceedingToCart"))("type",i.globalMessageType.MSG_TYPE_ERROR),n(4),c("ngForOf",e),n(2),h(" ",b(7,9,"quickOrderList.errors.outOfStockErrorFound",O(12,ee,e.length))," ")}}function zi(t,d){if(t&1&&(C(0),m(1,Ki,8,14,"cx-message",8),v()),t&2){let e=d.ngIf;n(),c("ngIf",e.length)}}function Xi(t,d){if(t&1&&(u(0,"li",18)(1,"span"),_(2),a(3,"cxTranslate"),p()()),t&2){let e=d.$implicit;n(2),h(" ",b(3,1,"quickOrderList.warnings.productWasReduced",Ke(4,Di,e.entry.product.name,e.entry.product.code,e.quantityAdded))," ")}}function Ji(t,d){if(t&1){let e=T();u(0,"cx-message",15),a(1,"cxTranslate"),a(2,"cxTranslate"),F("closeMessage",function(){f(e);let r=s(2);return g(r.clearWarnings())}),u(3,"ul",16),m(4,Xi,4,8,"li",17),p(),u(5,"div",12),_(6),a(7,"cxTranslate"),p()()}if(t&2){let e=s().ngIf,i=s();c("accordionText",l(1,5,"quickOrderList.warnings.reviewWarnings"))("text",l(2,7,"quickOrderList.warningProceedingToCart"))("type",i.globalMessageType.MSG_TYPE_WARNING),n(4),c("ngForOf",e),n(2),h(" ",b(7,9,"quickOrderList.warnings.reduceWarningFound",O(12,ee,e.length))," ")}}function Zi(t,d){if(t&1&&(C(0),m(1,Ji,8,14,"cx-message",14),v()),t&2){let e=d.ngIf;n(),c("ngIf",e.length)}}function er(t,d){if(t&1&&(u(0,"li",23)(1,"span"),_(2),a(3,"cxTranslate"),p()()),t&2){let e=d.$implicit;n(2),K(b(3,1,"quickOrderList.successes.productAddedToCart",ne(4,Rt,e.product.name,e.product.code)))}}function tr(t,d){if(t&1){let e=T();u(0,"cx-message",20),a(1,"cxTranslate"),F("closeMessage",function(){f(e);let r=s(2);return g(r.clearSuccesses())}),u(2,"ul",21),m(3,er,4,7,"li",22),p(),u(4,"div",12),_(5),a(6,"cxTranslate"),p()()}if(t&2){let e=s().ngIf,i=s();c("text",l(1,4,"quickOrderList.successfullyAddedToCart"))("type",i.globalMessageType.MSG_TYPE_CONFIRMATION),n(3),c("ngForOf",e),n(2),h(" ",b(6,6,"quickOrderList.successes.addedToCartFound",O(9,ee,e.length))," ")}}function ir(t,d){if(t&1&&(C(0),m(1,tr,7,11,"cx-message",19),v()),t&2){let e=d.ngIf;n(),c("ngIf",e.length)}}function rr(t,d){if(t&1){let e=T();u(0,"button",33),a(1,"async"),a(2,"cxTranslate"),F("click",function(){f(e);let r=s(3);return g(r.clear())}),_(3),a(4,"cxTranslate"),p()}if(t&2){let e=s(3);c("disabled",!l(1,3,e.isCartStable$)),w("aria-label",l(2,5,"quickOrderList.emptyList")),n(3),h(" ",l(4,7,"quickOrderList.emptyList")," ")}}function nr(t,d){if(t&1){let e=T();C(0),u(1,"div",24)(2,"h2"),_(3),a(4,"cxTranslate"),p(),u(5,"p"),_(6),a(7,"cxTranslate"),p()(),u(8,"div",25),k(9,"cx-quick-order-form",26,0),p(),u(11,"div",27),k(12,"cx-quick-order-table",28),a(13,"async"),p(),u(14,"div",29)(15,"div",30),m(16,rr,5,9,"button",31),p(),u(17,"div",30)(18,"cx-progress-button",32),a(19,"cxTranslate"),a(20,"async"),F("clickEvent",function(){let r=f(e).ngIf,o=s(2);return g(o.addToCart(r))}),_(21),a(22,"cxTranslate"),p()()(),v()}if(t&2){let e=d.ngIf,i=s().ngIf,r=s();n(3),h(" ",l(4,11,"quickOrderList.header")," "),n(3),h(" ",b(7,13,"quickOrderList.subHeader",O(24,$t,i))," "),n(3),c("limit",i),n(3),c("entries",e)("loading",!l(13,16,r.isCartStable$)),n(4),c("ngIf",e.length),n(2),He("btn-block add-button"),c("ariaLabel",l(19,18,"quickOrderList.addToCart"))("loading",!l(20,20,r.isCartStable$)),n(3),h(" ",l(22,22,"quickOrderList.addToCart")," ")}}function or(t,d){if(t&1&&(C(0),m(1,nr,23,26,"ng-container",2),a(2,"async"),v()),t&2){let e=s();n(),c("ngIf",l(2,1,e.entries$))}}var cr=(()=>{class t{constructor(e,i,r,o){this.activeCartService=e,this.eventService=i,this.formBuilder=r,this.globalMessageService=o,this.featureConfig=te(be),this.cartIsLoading$=this.activeCartService.isStable().pipe(P(x=>!x)),this.cart$=this.activeCartService.getActive(),this.min=1,this.subscription=new I,this.cartEventsSubscription=new I,this.minQuantityValue=1,J("a11yQTY2Quantity")}ngOnInit(){this.buildForm(),this.watchQuantityChange()}ngOnDestroy(){this.subscription?.unsubscribe(),this.cartEventsSubscription?.unsubscribe()}applyQuickOrder(){if(this.quickOrderForm.invalid){this.quickOrderForm.markAllAsTouched();return}let e=this.quickOrderForm.get("productCode")?.value,i=this.quickOrderForm.get("quantity")?.value;this.watchAddEntrySuccessEvent(),e&&i&&this.activeCartService.addEntry(e,i)}buildForm(){let e=!this.featureConfig.isEnabled("a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields");this.quickOrderForm=this.formBuilder.group({productCode:["",e?[we.required]:[]],quantity:[this.minQuantityValue,{updateOn:"blur",validators:e?[we.required]:[]}]})}watchQuantityChange(){this.subscription.add(this.quickOrderForm.get("quantity")?.valueChanges.subscribe(e=>this.quickOrderForm.get("quantity")?.setValue(this.getValidCount(e),{emitEvent:!1})))}watchAddEntrySuccessEvent(){this.cartEventsSubscription.add(this.eventService.get(pe).pipe(G()).subscribe(e=>{let i="quickOrderCartForm.stockLevelReached",r,o=N.MSG_TYPE_WARNING;e.quantityAdded&&(i=e.quantityAdded>1?"quickOrderCartForm.entriesWereAdded":"quickOrderCartForm.entryWasAdded",r=e.quantityAdded>1?"quickOrderCartForm.products":"quickOrderCartForm.product",o=N.MSG_TYPE_CONFIRMATION),this.globalMessageService.add({key:i,params:{product:e?.entry?.product?.name||r,quantity:e.quantityAdded}},o),this.resetForm()}))}getValidCount(e){return(e<this.min||!e)&&(e=this.min),e}resetForm(){this.quickOrderForm.reset()}static{this.\u0275fac=function(i){return new(i||t)(q(Z),q(se),q(ft),q(Oe))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-cart-quick-order-form"]],standalone:!1,decls:4,vars:3,consts:[["requiredAsterisk",""],[4,"ngIf"],[1,"cx-cart-quick-order-form-title"],[1,"form-group"],[3,"ngSubmit","formGroup"],[1,"cx-cart-quick-order-form-container"],[4,"cxFeature"],[1,"cx-cart-quick-order-form-productID"],[1,"cx-cart-quick-order-form-label"],[3,"ngTemplateOutlet"],[1,"cx-cart-quick-order-form-qty"],["class","cx-cart-quick-order-form-label",4,"cxFeature"],["formControlName","productCode","type","text",1,"form-control","input-product-code",3,"placeholder"],["aria-required","true","formControlName","productCode","required","true","type","text",1,"form-control","input-product-code",3,"placeholder"],["formControlName","quantity","type","number",1,"form-control","input-quantity"],["aria-required","true","formControlName","quantity","required","true","type","number",1,"form-control","input-quantity"],["type","submit",1,"btn","btn-block","btn-secondary","apply-quick-order-button",3,"disabled"],[3,"translationParams","control",4,"cxFeature"],[3,"control",4,"cxFeature"],[3,"translationParams","control"],[3,"control"]],template:function(i,r){i&1&&(m(0,di,22,17,"ng-container",1),a(1,"async"),m(2,ui,1,1,"ng-template",null,0,he)),i&2&&c("ngIf",l(1,1,r.cart$))},dependencies:[z,Je,Ie,Te,mt,Se,Ee,_t,Qe,Me,bt,X,le,ue,ce,j],encapsulation:2,changeDetection:0})}}return t})(),ar=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=A({type:t})}static{this.\u0275inj=B({providers:[ve({cmsComponents:{CartQuickOrderFormComponent:{component:cr}}})],imports:[ke,Pe,Fe,Ae,qe,le,ue]})}}return t})(),sr=(()=>{class t{constructor(e,i){this.quickOrderService=e,this.productConnector=i,this.type=Et.QUICK_ORDER,this.logger=te(rt)}getEntries(){return this.quickOrderService.getEntries()}addEntries(e){return Ge(e.map(i=>this.quickOrderService.canAdd(i.productCode,e).pipe(Y(r=>r?this.productConnector.get(i.productCode).pipe($(o=>!!o),W(o=>{this.quickOrderService.addProduct(o,i.quantity)}),P(o=>this.handleResults(o,i)),Ye(o=>M(this.handleErrors(o,i.productCode)))):M({productCode:i.productCode,statusCode:V.LIMIT_EXCEEDED}))))).pipe(Ne(),R(e.length))}handleResults(e,i){return e.stock?.stockLevel&&i.quantity>e.stock.stockLevel?{productCode:i.productCode,productName:e?.name,statusCode:V.LOW_STOCK,quantity:i.quantity,quantityAdded:e.stock.stockLevel}:e.stock?.stockLevelStatus==="outOfStock"?{productCode:i.productCode,statusCode:V.NO_STOCK,productName:e?.name}:{productCode:i.productCode,statusCode:V.SUCCESS}}handleErrors(e,i){return e?.error?.errors[0].type==="UnknownIdentifierError"?{productCode:i,statusCode:V.UNKNOWN_IDENTIFIER}:(ze()&&this.logger.warn("Unrecognized cart add entry action type while mapping messages",e),{productCode:i,statusCode:V.UNKNOWN_ERROR})}static{this.\u0275fac=function(i){return new(i||t)(S(Q),S(lt))}}static{this.\u0275prov=U({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),me="quick-order-searchbox-is-active",dr=(()=>{class t{constructor(e,i,r,o){this.config=e,this.cd=i,this.quickOrderService=r,this.winRef=o,this.iconTypes=gt,this.isSearching=!1,this.noResults=!1,this.results=[],this.featureConfigService=te(be),this.subscription=new I,this.searchSubscription=new I,J("a11yPreventSRFocusOnHiddenElements")}ngOnInit(){this.buildForm(),this.subscription.add(this.watchProductAdd()),this.subscription.add(this.watchQueryChange())}onBlur(e){setTimeout(()=>{this.isSuggestionFocused()||this.blurSuggestionBox(e)})}clear(e){e?.preventDefault(),this.isResultsBoxOpen()&&(this.toggleBodyClass(me,!1),this.featureConfigService.isEnabled("a11yQuickOrderSearchBoxRefocusOnClose")&&requestAnimationFrame(()=>{this.quickOrderInput.nativeElement.focus()})),this.form.get("product")?.value&&this.form.reset(),this.close(),this.cd?.detectChanges()}add(e,i){if(i?.preventDefault(),e.multidimensional){this.quickOrderService.setNonPurchasableProductError(e),this.clear();return}else this.quickOrderService.clearNonPurchasableProductError();this.quickOrderService.addProduct(e),this.quickOrderInput.nativeElement.focus()}addProduct(e){this.quickOrderService.canAdd().pipe(R(1)).subscribe(i=>{if(i){if(this.results.length===1)this.add(this.results[0],e);else if(this.getFocusedIndex()!==-1){let r=this.results[this.getFocusedIndex()];this.add(r,e)}}})}focusNextChild(e){if(e.preventDefault(),!this.results.length)return;let[i,r]=[this.getResultElements(),this.getFocusedIndex()];i.length&&(this.featureConfigService.isEnabled("a11ySearchableDropdownFirstElementFocus")&&this.winRef.document.querySelector("main")?.classList.remove("mouse-focus"),r>=i.length-1?i[0].focus():i[r+1].focus())}focusPreviousChild(e){if(e.preventDefault(),!this.results.length)return;let[i,r]=[this.getResultElements(),this.getFocusedIndex()];i.length&&(r<1?i[i.length-1].focus():i[r-1].focus())}isResultsBoxOpen(){return this.winRef?!!this.winRef.document.querySelector(`.${me}`):!1}canAddProduct(){return this.quickOrderService.canAdd()}open(){this.toggleBodyClass(me,!0)}getResultElements(){return this.winRef?Array.from(this.winRef.document.querySelectorAll(".quick-order-results-products > li button")):[]}blurSuggestionBox(e){this.toggleBodyClass(me,!1),e&&e.target&&e.target.blur()}getFocusedElement(){if(this.winRef)return this.winRef.document.activeElement}getFocusedIndex(){return this.getResultElements().indexOf(this.getFocusedElement())}isSuggestionFocused(){return this.getResultElements().includes(this.getFocusedElement())}toggleBodyClass(e,i){this.winRef&&(i===void 0?this.winRef.document.body.classList.toggle(e):i?this.winRef.document.body.classList.add(e):this.winRef.document.body.classList.remove(e))}buildForm(){let e=new pt({});e.setControl("product",new de(null)),this.form=e}isEmpty(e){return e?.trim()===""||e==null}watchQueryChange(){return this.form.valueChanges.pipe(Ue(),We(300),$(e=>this.config?.quickOrder?.searchForm?this.isEmpty(e.product)?(this.clear(),!1):!!e.product&&e.product.length>=this.config.quickOrder?.searchForm?.minCharactersBeforeRequest:e)).subscribe(e=>{this.searchProducts(e.product)})}searchProducts(e){this.searchSubscription.add(this.canAddProduct().pipe($(Boolean),Y(()=>this.quickOrderService.searchProducts(e,this.config?.quickOrder?.searchForm?.maxProducts).pipe(R(1)))).subscribe(i=>{this.results=i,this.results.length?(this.noResults=!1,this.open()):this.noResults=!0,this.cd?.detectChanges()}))}clearResults(){this.results=[]}close(){this.resetSearchSubscription(),this.clearResults(),this.noResults=!1}resetSearchSubscription(){this.searchSubscription.unsubscribe(),this.searchSubscription=new I}watchProductAdd(){return this.quickOrderService.getProductAdded().subscribe(()=>this.clear())}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(i){return new(i||t)(q(ae),q(ye),q(Q),q(it))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-quick-order-form"]],viewQuery:function(i,r){if(i&1&&_e(pi,5),i&2){let o;fe(o=ge())&&(r.quickOrderInput=o.first)}},inputs:{limit:"limit"},standalone:!1,decls:18,vars:30,consts:[["quickOrderInput",""],["searchIcon",""],[1,"quick-order-form-container",3,"formGroup"],["role","combobox","aria-controls","quick-order-search-results",1,"quick-order-form-input"],["aria-controls","quick-order-search-results","aria-describedby","quickOrderFormInitialDescription","formControlName","product","type","text",1,"form-control",3,"blur","focus","keydown.arrowdown","keydown.arrowup","keydown.enter","keydown.escape","placeholder"],["class","quick-order-form-reset-icon",3,"click","keydown.enter",4,"ngIf","ngIfElse"],["class","list-limit-reached-text","role","alert",4,"ngIf"],["id","quick-order-search-results","class","quick-order-results",4,"cxFeature"],[4,"cxFeature"],["aria-live","polite","id","quickOrderFormInitialDescription","aria-atomic","true",1,"cx-visually-hidden","quick-order-form-description"],[1,"quick-order-form-reset-icon",3,"click","keydown.enter"],[3,"type"],["tabindex","-1",1,"quick-order-form-search-icon"],["role","alert",1,"list-limit-reached-text"],["id","quick-order-search-results",1,"quick-order-results"],["class","quick-order-results-products","role","listbox",4,"ngIf"],["class","quick-order-no-results",4,"ngIf"],["role","listbox",1,"quick-order-results-products"],["class","quick-order-results-product-container",4,"ngFor","ngForOf"],[1,"quick-order-results-product-container"],["class","quick-order-results-product","role","option",3,"has-media","blur","mousedown","keydown.arrowdown","keydown.arrowup","keydown.enter","keydown.escape",4,"cxFeature"],["class","quick-order-results-product","role","option",3,"has-media","blur","mousedown","keydown.arrowdown","keydown.arrowup","keydown.enter","keydown.escape","keydown.tab","keydown.shift.tab",4,"cxFeature"],["role","option",1,"quick-order-results-product",3,"blur","mousedown","keydown.arrowdown","keydown.arrowup","keydown.enter","keydown.escape"],["class","media","format","thumbnail","role","presentation",3,"alt","container",4,"ngIf"],[1,"name",3,"innerHTML"],[1,"id"],[1,"price"],["format","thumbnail","role","presentation",1,"media",3,"alt","container"],["role","option",1,"quick-order-results-product",3,"blur","mousedown","keydown.arrowdown","keydown.arrowup","keydown.enter","keydown.escape","keydown.tab","keydown.shift.tab"],[1,"quick-order-no-results"],["class","quick-order-results","role","dialog","id","quick-order-search-results",4,"ngIf"],["role","dialog","id","quick-order-search-results",1,"quick-order-results"]],template:function(i,r){if(i&1){let o=T();u(0,"form",2)(1,"div",3),a(2,"cxTranslate"),u(3,"input",4,0),a(5,"cxTranslate"),a(6,"cxTranslate"),F("blur",function(y){return f(o),g(r.onBlur(y))})("focus",function(){return f(o),g(r.open())})("keydown.arrowdown",function(y){return f(o),g(r.focusNextChild(y))})("keydown.arrowup",function(y){return f(o),g(r.focusPreviousChild(y))})("keydown.enter",function(y){return f(o),g(r.addProduct(y))})("keydown.escape",function(y){return f(o),g(r.clear(y))}),p(),m(7,mi,4,7,"button",5)(8,_i,4,7,"ng-template",null,1,he)(10,fi,3,3,"span",6),a(11,"async"),p(),m(12,Oi,3,2,"div",7)(13,Si,2,1,"ng-container",8),p(),u(14,"label",9),_(15),a(16,"cxTranslate"),a(17,"cxTranslate"),p()}if(i&2){let o,x,y=H(9);c("formGroup",r.form),n(),w("aria-expanded",r.isResultsBoxOpen())("aria-label",l(2,12,"quickOrderForm.quickOrderSearch")),n(2),re("placeholder",l(5,14,"quickOrderForm.placeholder")),w("aria-label",b(6,16,"quickOrderForm.searchBoxLabel",O(26,$t,r.limit))),n(4),c("ngIf",(o=r.form.get("product"))==null?null:o.value)("ngIfElse",y),n(3),c("ngIf",!l(11,19,r.canAddProduct())&&((x=r.form.get("product"))==null?null:x.dirty)),n(2),c("cxFeature","a11yQuickOrderAriaControls"),n(),c("cxFeature","!a11yQuickOrderAriaControls"),n(2),xe(" ",r.results.length?b(16,21,"quickOrderForm.productsResults",O(28,ee,r.results.length)):""," ",l(17,24,"quickOrderForm.initialDescription"),`
`)}},dependencies:[oe,z,xt,Be,Ie,Te,Se,Ee,Qe,Me,X,ce,j],encapsulation:2,changeDetection:0})}}return t})(),lr=(()=>{class t{get entry(){return this._entry}set entry(e){this._entry=e,this.quantityControl=new de(this.entry.quantity,{updateOn:"blur"})}constructor(e,i){this.cd=e,this.quickOrderService=i,this.loading=!1,this.subscription=new I,J("a11yQTY2Quantity")}ngOnInit(){this.subscription.add(this.quantityControl.valueChanges.subscribe(()=>{this.quickOrderService.updateEntryQuantity(this.index,this.quantityControl.value)})),this.subscription.add(this.watchProductAdd())}removeEntry(){this.quickOrderService.softDeleteEntry(this.index),this.cd.detectChanges()}watchProductAdd(){return this.quickOrderService.getProductAdded().subscribe(e=>{e===this.entry.product?.code&&(this.quantityControl=new de(this.entry.quantity),this.cd.detectChanges())})}ngOnDestroy(){this.subscription?.unsubscribe()}static{this.\u0275fac=function(i){return new(i||t)(q(ye),q(Q))}}static{this.\u0275cmp=D({type:t,selectors:[["","cx-quick-order-item",""],["cx-quick-order-item"]],inputs:{entry:"entry",index:"index",loading:"loading"},standalone:!1,attrs:Ei,decls:29,vars:40,consts:[["role","cell"],[1,"cx-table-item-container"],["tabindex","-1",3,"ngClass","routerLink"],["format","cartIcon",3,"container","alt"],[1,"cx-info"],[1,"cx-name"],[1,"cx-link",3,"ngClass","routerLink"],[1,"cx-code"],["role","cell",1,"cx-price"],[1,"cx-mobile-header"],[1,"cx-value"],["role","cell",1,"cx-quantity"],["class","cx-mobile-header",4,"cxFeature"],[3,"control","max","readonly"],["role","cell",1,"cx-actions"],[1,"btn","btn-tertiary",3,"click","disabled"]],template:function(i,r){i&1&&(u(0,"td",0)(1,"div",1)(2,"a",2),a(3,"cxUrl"),k(4,"cx-media",3),p(),u(5,"div",4)(6,"div",5)(7,"a",6),a(8,"cxUrl"),_(9),p()(),u(10,"div",7),_(11),a(12,"cxTranslate"),p()()()(),u(13,"td",8)(14,"div",9),_(15),a(16,"cxTranslate"),p(),u(17,"div",10),_(18),p()(),u(19,"td",11),m(20,Mi,3,3,"div",12)(21,Pi,3,3,"div",12),u(22,"div",10),k(23,"cx-item-counter",13),p()(),u(24,"td",14)(25,"button",15),a(26,"cxTranslate"),F("click",function(){return r.removeEntry()}),_(27),a(28,"cxTranslate"),p()()),i&2&&(n(2),c("ngClass",ne(31,Ii,r.loading,!(!(r.entry==null||r.entry.product==null||r.entry.product.images==null)&&r.entry.product.images.PRIMARY)))("routerLink",l(3,19,O(34,At,r.entry.product))),n(2),c("container",r.entry==null||r.entry.product==null||r.entry.product.images==null?null:r.entry.product.images.PRIMARY)("alt",r.entry==null||r.entry.product==null?null:r.entry.product.name),n(3),c("ngClass",O(36,Qi,r.loading))("routerLink",l(8,21,O(38,At,r.entry.product))),n(2),h("",(r.entry.product==null?null:r.entry.product.name)||"-"," "),n(2),xe(" ",l(12,23,"quickOrderTable.id")," ",r.entry.product==null?null:r.entry.product.code," "),n(4),h(" ",l(16,25,"quickOrderTable.itemPrice")," "),n(3),h(" ",(r.entry.basePrice==null?null:r.entry.basePrice.formattedValue)||"-"," "),n(2),c("cxFeature","a11yQTY2Quantity"),n(),c("cxFeature","!a11yQTY2Quantity"),n(2),c("control",r.quantityControl)("max",r.entry.product==null||r.entry.product.stock==null?null:r.entry.product.stock.stockLevel)("readonly",r.loading),n(2),c("disabled",r.loading),w("aria-label",l(26,27,"common.remove")),n(2),h(" ",l(28,29,"common.remove")," "))},dependencies:[Xe,qt,Be,et,X,j,st],encapsulation:2,changeDetection:0})}}return t})(),ur=(()=>{class t{constructor(){this.entries=[],this.loading=!1,J("a11yQTY2Quantity")}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=D({type:t,selectors:[["cx-quick-order-table"]],inputs:{entries:"entries",loading:"loading"},standalone:!1,decls:1,vars:1,consts:[["class","cx-quick-order-table-wrapper","role","table",4,"ngIf"],["role","table",1,"cx-quick-order-table-wrapper"],[1,"cx-visually-hidden"],["role","row",1,"cx-item-list-header","cx-quick-order-table-header"],["role","columnheader",1,"cx-item-list-desc"],["role","columnheader",1,"cx-item-list-price"],["role","columnheader","class","cx-item-list-qty",4,"cxFeature"],["role","columnheader",1,"cx-item-list-actions"],[1,"cx-item-list-items"],["cx-quick-order-item","","class","cx-item-list-row cx-quick-order-table-row",3,"entry","index","loading",4,"ngFor","ngForOf"],["role","columnheader",1,"cx-item-list-qty"],["cx-quick-order-item","",1,"cx-item-list-row","cx-quick-order-table-row",3,"entry","index","loading"]],template:function(i,r){i&1&&m(0,$i,19,15,"table",0),i&2&&c("ngIf",(r.entries==null?null:r.entries.length)>0)},dependencies:[oe,z,X,lr,j],encapsulation:2,changeDetection:0})}}return t})(),pr=(()=>{class t{constructor(e,i,r,o,x){this.activeCartService=e,this.component=i,this.globalMessageService=r,this.quickOrderService=o,this.quickOrderStatePersistenceService=x,this.quickOrderListLimit$=this.component.data$.pipe(P(y=>y.quickOrderListLimit),W(y=>{y&&this.quickOrderService.setListLimit(y)})),this.isCartStable$=Le([this.activeCartService.getActiveCartId(),this.activeCartService.isStable()]).pipe(P(([y,Lt])=>y?Lt:!0)),this.globalMessageType=N,this.cartErrors$=new E([]),this.cartWarnings$=new E([]),this.cartSuccesses$=new E([]),this.showAddToCartInformation$=new E(!1),this.nonPurchasableProductError$=new E(null)}ngOnInit(){this.cartId$=this.activeCartService.getActiveCartId(),this.entries$=this.quickOrderService.getEntries(),this.quickOrderStatePersistenceService.initSync()}ngOnDestroy(){this.quickOrderService.clearDeletedEntries()}get errors$(){return this.cartErrors$.asObservable()}get warnings$(){return this.cartWarnings$.asObservable()}get successes$(){return this.cartSuccesses$.asObservable()}get nonPurchasableError$(){return this.quickOrderService.getNonPurchasableProductError()}get addToCartInformation$(){return this.showAddToCartInformation$.asObservable()}get softDeletedEntries$(){return this.quickOrderService.getSoftDeletedEntries()}clear(){this.quickOrderService.clearList(),this.globalMessageService.add({key:"quickOrderTable.listCleared"},N.MSG_TYPE_INFO)}addToCart(e){if(!e.length){this.showAddToCartInformation$.next(!0);return}this.clearStatuses(),this.quickOrderService.addToCart().pipe(G()).subscribe(([i,r])=>{r.forEach(o=>{o.entry||(o.entry=e.find(x=>x.product?.code===o.productCode))}),this.extractErrors(r),this.extractWarnings(r),r.length?this.extractSuccesses(r,i):this.showAddedToCartSuccessMessage()})}clearErrors(){this.cartErrors$.next([])}clearWarnings(){this.cartWarnings$.next([])}clearSuccesses(){this.cartSuccesses$.next([])}clearAddToCartInformation(){this.showAddToCartInformation$.next(!1)}undoDeletion(e){e.product?.code&&this.quickOrderService.restoreSoftDeletedEntry(e.product.code)}clearDeletion(e){e.product?.code&&this.quickOrderService.hardDeleteEntry(e.product.code)}clearNonPurchasableError(){this.quickOrderService.clearNonPurchasableProductError()}canAddProduct(){return this.quickOrderService.canAdd()}extractErrors(e){let i=e.filter(r=>r.quantityAdded===0);this.setErrors(i)}extractWarnings(e){let i=e.filter(r=>r.quantityAdded!==0);this.setWarnings(i)}extractSuccesses(e,i){let r=[];i.forEach(o=>{e.find(y=>y.productCode===o.product?.code)||r.push(o)}),this.setSuccesses(r)}clearStatuses(){this.clearErrors(),this.clearWarnings(),this.clearSuccesses()}showAddedToCartSuccessMessage(){this.globalMessageService.add({key:"quickOrderTable.addedtoCart"},N.MSG_TYPE_CONFIRMATION)}setErrors(e){this.cartErrors$.next(e)}setWarnings(e){this.cartWarnings$.next(e)}setSuccesses(e){this.cartSuccesses$.next(e)}static{this.\u0275fac=function(i){return new(i||t)(q(Z),q(kt),q(Oe),q(Q),q(Ve))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-quick-order"]],viewQuery:function(i,r){if(i&1&&_e(Ri,5),i&2){let o;fe(o=ge())&&(r.quickOrderForm=o.first)}},standalone:!1,decls:17,vars:24,consts:[["quickOrderForm",""],["aria-atomic","true","aria-live","assertive","aria-relevant","additions",1,"quick-order-message-container"],[4,"ngIf"],[1,"quick-order-list-limit-message",3,"text","isVisibleCloseButton","type"],[1,"quick-order-add-to-cart-information-message",3,"closeMessage","text","type"],[1,"quick-order-non-purchasable-product-error-message",3,"closeMessage","text","type"],["class","quick-order-deletions-message",3,"actionButtonText","actionButtonMessage","text","type","buttonAction","closeMessage",4,"ngFor","ngForOf"],[1,"quick-order-deletions-message",3,"buttonAction","closeMessage","actionButtonText","actionButtonMessage","text","type"],["class","quick-order-errors-message",3,"accordionText","text","type","closeMessage",4,"ngIf"],[1,"quick-order-errors-message",3,"closeMessage","accordionText","text","type"],[1,"quick-order-errors"],["class","quick-order-error-item",4,"ngFor","ngForOf"],[1,"cx-visually-hidden"],[1,"quick-order-error-item"],["class","quick-order-warnings-message",3,"accordionText","text","type","closeMessage",4,"ngIf"],[1,"quick-order-warnings-message",3,"closeMessage","accordionText","text","type"],[1,"quick-order-warnings"],["class","quick-order-warning-item",4,"ngFor","ngForOf"],[1,"quick-order-warning-item"],["class","quick-order-successes-message",3,"text","type","closeMessage",4,"ngIf"],[1,"quick-order-successes-message",3,"closeMessage","text","type"],[1,"quick-order-successes"],["class","quick-order-success-item",4,"ngFor","ngForOf"],[1,"quick-order-success-item"],[1,"quick-order-header"],[1,"quick-order-form-body"],[3,"limit"],[1,"quick-order-table-body"],[3,"entries","loading"],[1,"quick-order-footer","row"],[1,"col-xs-12","col-md-5","col-lg-3"],["class","btn btn-block btn-secondary clear-button","type","button",3,"disabled","click",4,"ngIf"],[3,"clickEvent","ariaLabel","loading"],["type","button",1,"btn","btn-block","btn-secondary","clear-button",3,"click","disabled"]],template:function(i,r){i&1&&(u(0,"div",1),m(1,ji,3,3,"ng-container",2),a(2,"async"),m(3,Gi,3,4,"ng-container",2),a(4,"async"),m(5,Yi,3,7,"ng-container",2),a(6,"async"),m(7,Ui,3,3,"ng-container",2),a(8,"async"),m(9,zi,2,1,"ng-container",2),a(10,"async"),m(11,Zi,2,1,"ng-container",2),a(12,"async"),m(13,ir,2,1,"ng-container",2),a(14,"async"),p(),m(15,or,3,3,"ng-container",2),a(16,"async")),i&2&&(n(),c("ngIf",l(2,8,r.entries$)),n(2),c("ngIf",l(4,10,r.addToCartInformation$)),n(2),c("ngIf",l(6,12,r.nonPurchasableError$)),n(2),c("ngIf",l(8,14,r.softDeletedEntries$)),n(2),c("ngIf",l(10,16,r.errors$)),n(2),c("ngIf",l(12,18,r.warnings$)),n(2),c("ngIf",l(14,20,r.successes$)),n(2),c("ngIf",l(16,22,r.quickOrderListLimit$)))},dependencies:[oe,z,yt,Tt,dr,ur,ce,Ze,j],encapsulation:2,changeDetection:0})}}return t})(),mr=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=A({type:t})}static{this.\u0275inj=B({providers:[ve({cmsComponents:{QuickOrderComponent:{component:pr,data:{quickOrderListLimit:10}}}})],imports:[Ct,ke,Ae,Fe,ht,Ft,Ot,vt,wt,Pe,Ce,dt,qe]})}}return t})(),Dt=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=A({type:t})}static{this.\u0275inj=B({providers:[{provide:Qt,useExisting:sr}],imports:[Ce,mr,ar]})}}return t})();var Nr=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=A({type:t})}static{this.\u0275inj=B({imports:[Bt,Dt]})}}return t})();export{Nr as QuickOrderModule};
