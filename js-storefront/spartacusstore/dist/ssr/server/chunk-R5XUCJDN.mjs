import './polyfills.server.mjs';
import{a as kt}from"./chunk-D2CXG3O3.mjs";import{N as z,O as J,P as mt,Q as D}from"./chunk-HCL456IH.mjs";import{Q as V,Tb as Ut,Ub as $t,V as j,X as At,Z as Dt,_ as q,ea as wt,oa as Ft,qa as Lt}from"./chunk-M3PBDWUL.mjs";import{$g as Pt,Ce as Ot,D as rt,Db as f,Eb as _,Fb as L,Fg as Nt,Gb as g,Ge as Rt,Hb as m,Ib as ct,Jb as st,Lb as ut,M as R,Mb as a,Pb as H,Rd as vt,Re as bt,Td as gt,Vb as lt,Wb as y,We as $,Xa as o,Xb as U,Xc as ft,Xg as Bt,Yb as C,Yc as N,ah as k,bd as B,cb as I,dc as dt,eb as b,ec as pt,fb as T,fc as xt,hd as P,i as h,jb as d,kc as s,lc as u,ma as Y,mc as X,mh as Mt,n as it,na as v,nh as M,oh as A,pa as Q,pc as ht,q as O,qa as F,qe as Tt,sb as S,tb as c,vb as It,wa as ot,wc as Et,xa as at,xg as St}from"./chunk-JI3YDV22.mjs";var Gt=(e,r,t)=>({ownerType:e,entityKey:r,displayOnly:t}),Kt=(e,r)=>({cxRoute:e,params:r});function Yt(e,r){e&1&&ct(0)}function Qt(e,r){if(e&1&&(f(0,"label",4),d(1,Yt,1,0,"ng-container",5),_()),e&2){a(2);let t=lt(3),n=a();o(),c("ngIf",n.isDisabled())("ngIfThen",t)}}function Ht(e,r){e&1&&ct(0)}function Xt(e,r){if(e&1&&(f(0,"a",6),s(1,"cxUrl"),s(2,"async"),d(3,Ht,1,0,"ng-container",5),_()),e&2){let t=a(2).ngIf,n=lt(3),i=a();c("routerLink",u(1,5,pt(13,Kt,i.getRoute(),xt(9,Gt,i.retrieveOwnerTypeFromAbstractOrderType(t),i.retrieveEntityKey(t),i.getDisplayOnly()))))("queryParams",u(2,7,i.queryParams$)),S("aria-describedby",i.getResolveIssuesA11yDescription()),o(3),c("ngIf",!i.isDisabled())("ngIfThen",n)}}function zt(e,r){if(e&1&&(g(0),d(1,Qt,2,2,"label",2)(2,Xt,4,16,"a",3),m()),e&2){let t=a(2);o(),c("ngIf",t.isDisabled()),o(),c("ngIf",!t.isDisabled())}}function Jt(e,r){e&1&&(g(0),y(1),s(2,"cxTranslate"),m()),e&2&&(o(),C(" ",u(2,1,"configurator.header.displayConfiguration"),""))}function Zt(e,r){e&1&&(g(0),y(1),s(2,"cxTranslate"),m()),e&2&&(o(),C(" ",u(2,1,"configurator.header.editConfiguration")," "))}function te(e,r){e&1&&(g(0),y(1),s(2,"cxTranslate"),m()),e&2&&(o(),C(" ",u(2,1,"configurator.header.resolveIssues")," "))}function ee(e,r){if(e&1&&d(0,Jt,3,3,"ng-container",1)(1,Zt,3,3,"ng-container",1)(2,te,3,3,"ng-container",1),e&2){let t=a(2);c("ngIf",t.getDisplayOnly()),o(),c("ngIf",!t.getDisplayOnly()&&!t.msgBanner),o(),c("ngIf",!t.getDisplayOnly()&&t.msgBanner)}}function ne(e,r){if(e&1&&(g(0),d(1,zt,3,2,"ng-container",1)(2,ee,3,3,"ng-template",null,0,ht),m()),e&2){let t=a();o(),c("ngIf",t.cartEntry)}}var jt=e=>({count:e});function ie(e,r){if(e&1&&(L(0,"cx-configure-cart-entry",4),s(1,"async")),e&2){let t,n=a().ngIf,i=a(2).ngIf,l=a();c("cartEntry",i)("readOnly",(t=u(1,4,l.readonly$))!==null&&t!==void 0?t:!1)("msgBanner",!0)("disabled",n.disabled)}}function re(e,r){if(e&1&&(g(0),d(1,ie,2,6,"cx-configure-cart-entry",3),s(2,"async"),m()),e&2){let t=a(2).ngIf,n=a();o(),c("ngIf",u(2,1,n.shouldShowButton$)&&(t==null||t.product==null?null:t.product.configurable))}}function oe(e,r){if(e&1&&(g(0),L(1,"cx-icon",1),f(2,"div",2),y(3),s(4,"cxTranslate"),d(5,re,3,3,"ng-container",0),s(6,"async"),_(),m()),e&2){let t=a().ngIf,n=a();o(),c("type",n.iconTypes.ERROR),o(),H("id",n.getErrorMessageId(t)),o(),C(" ",X(4,4,"configurator.notificationBanner.numberOfIssues",dt(9,jt,n.getNumberOfIssues(t)))," "),o(2),c("ngIf",u(6,7,n.quantityControl$))}}function ae(e,r){if(e&1&&(g(0),d(1,oe,7,11,"ng-container",0),s(2,"async"),m()),e&2){let t=r.ngIf,n=a();o(),c("ngIf",n.hasIssues(t)&&!u(2,1,n.readonly$))}}var ce=(e,r)=>({attribute:e,value:r});function se(e,r){e&1&&(f(0,"span",3),y(1),s(2,"cxTranslate"),_()),e&2&&(o(),C(" ",u(2,1,"configurator.a11y.cartEntryInfoIntro")," "))}function ue(e,r){if(e&1&&(f(0,"div",4)(1,"span",5),y(2),s(3,"cxTranslate"),_(),f(4,"div",6),y(5),_(),f(6,"div",7),y(7),_()()),e&2){let t=r.$implicit,n=r.index,i=a(4);S("aria-describedby",i.getHiddenConfigurationInfoId(n)),o(),H("id",i.getHiddenConfigurationInfoId(n)),o(),C(" ",X(3,5,"configurator.a11y.cartEntryInfo",pt(8,ce,t.configurationLabel,t.configurationValue))," "),o(3),C(" ",t==null?null:t.configurationLabel,": "),o(2),C(" ",t==null?null:t.configurationValue," ")}}function le(e,r){if(e&1&&(g(0),d(1,se,3,3,"span",1)(2,ue,8,11,"div",2),m()),e&2){let t,n=a(2).ngIf;o(),c("ngIf",(t=n.configurationInfos==null?null:n.configurationInfos.length)!==null&&t!==void 0?t:!1),o(),c("ngForOf",n.configurationInfos)}}function de(e,r){if(e&1&&(L(0,"cx-configure-cart-entry",9),s(1,"async")),e&2){let t,n=a().ngIf,i=a(2).ngIf,l=a();c("cartEntry",i)("readOnly",(t=u(1,4,l.readonly$))!==null&&t!==void 0?t:!1)("msgBanner",!1)("disabled",n.disabled)}}function pe(e,r){if(e&1&&(g(0),d(1,de,2,6,"cx-configure-cart-entry",8),s(2,"async"),m()),e&2){let t=a(2).ngIf,n=a();o(),c("ngIf",u(2,1,n.shouldShowButton$)&&(t==null||t.product==null?null:t.product.configurable))}}function fe(e,r){if(e&1&&(g(0),d(1,le,3,2,"ng-container",0)(2,pe,3,3,"ng-container",0),s(3,"async"),m()),e&2){let t=a().ngIf,n=a();o(),c("ngIf",n.hasStatus(t)),o(),c("ngIf",u(3,2,n.quantityControl$))}}function ge(e,r){if(e&1&&(g(0),d(1,fe,4,4,"ng-container",0),m()),e&2){let t=r.ngIf,n=a();o(),c("ngIf",n.isAttributeBasedConfigurator(t))}}function me(e,r){if(e&1){let t=st();g(0),f(1,"button",1),s(2,"cxTranslate"),ut("click",function(){ot(t);let i=a().ngIf,l=a();return at(l.navigateToConfigurator(i))}),y(3),s(4,"cxTranslate"),_(),m()}if(e&2){let t=a().ngIf,n=a();o(),S("aria-label",u(2,2,n.getAriaLabelTranslationKey(t.configuratorType))),o(2),C(" ",u(4,4,n.getTranslationKey(t.configuratorType))," ")}}function _e(e,r){if(e&1&&(g(0),d(1,me,5,6,"ng-container",0),m()),e&2){let t=r.ngIf,n=a();o(),c("ngIf",t.configurable&&!n.isReadOnlyBaseProduct(t))}}function ye(e,r){if(e&1&&(g(0),f(1,"span",11),y(2),s(3,"cxTranslate"),_(),f(4,"span",12),y(5),s(6,"cxNumeric"),_(),m()),e&2){let t=a().$implicit;o(2),U(u(3,2,"configurator.attribute.quantity")),o(3),U(u(6,4,t==null?null:t.formattedQuantity))}}function Ce(e,r){if(e&1&&(g(0),f(1,"span",11),y(2),s(3,"cxTranslate"),_(),f(4,"span",12),y(5),_(),m()),e&2){let t=a().$implicit;o(2),U(u(3,2,"configurator.overviewForm.itemPrice")),o(3),U(t==null?null:t.formattedPrice)}}function Ie(e,r){if(e&1&&(f(0,"div",6)(1,"span",7),y(2),_(),f(3,"div",8),y(4),_(),f(5,"div",9),d(6,ye,7,6,"ng-container",0),_(),f(7,"div",10),d(8,Ce,6,4,"ng-container",0),_()()),e&2){let t=r.$implicit,n=r.index,i=a(4);S("aria-describedby",i.getHiddenItemInfoId(n)),o(),H("id",i.getHiddenItemInfoId(n)),o(),C(" ",i.getHiddenItemInfo(t)," "),o(2),C(" ",t==null?null:t.name," "),o(2),c("ngIf",t==null?null:t.formattedQuantity),o(2),c("ngIf",t==null?null:t.formattedPrice)}}function xe(e,r){if(e&1){let t=st();g(0),f(1,"div",1),y(2),s(3,"cxTranslate"),_(),f(4,"button",2),ut("click",function(){ot(t);let i=a(3);return at(i.toggleItems())}),f(5,"div",3),y(6),_()(),f(7,"div",4),d(8,Ie,9,6,"div",5),s(9,"async"),_(),m()}if(e&2){let t=r.ngIf,n=a(3);o(2),C(" ",X(3,7,"configurator.header.items",dt(12,jt,t))," "),o(2),S("aria-expanded",!n.hideItems)("aria-label",n.getItemsMsg(t)),o(2),C(" ",n.getButtonText()," "),o(),It("open",!n.hideItems),o(),c("ngForOf",u(9,10,n.lineItems$))}}function he(e,r){if(e&1&&(L(0,"cx-configure-cart-entry",14),s(1,"async")),e&2){let t,n=a().ngIf,i=a(2).ngIf,l=a();c("cartEntry",i)("readOnly",(t=u(1,4,l.readonly$))!==null&&t!==void 0?t:!1)("msgBanner",!1)("disabled",n.disabled)}}function Ee(e,r){if(e&1&&(g(0),d(1,he,2,6,"cx-configure-cart-entry",13),s(2,"async"),m()),e&2){let t=a(2).ngIf,n=a();o(),c("ngIf",u(2,1,n.shouldShowButton$)&&(t==null||t.product==null?null:t.product.configurable))}}function ve(e,r){if(e&1&&(g(0),d(1,xe,10,14,"ng-container",0),s(2,"async"),d(3,Ee,3,3,"ng-container",0),s(4,"async"),m()),e&2){let t=a(2);o(),c("ngIf",u(2,2,t.numberOfLineItems$)),o(2),c("ngIf",u(4,4,t.quantityControl$))}}function Te(e,r){if(e&1&&(g(0),d(1,ve,5,6,"ng-container",0),m()),e&2){let t=r.ngIf,n=a();o(),c("ngIf",n.isBundleBasedConfigurator(t))}}var E;(function(e){let r;(function(t){t.PRODUCT="product",t.CART_ENTRY="cartEntry",t.ORDER_ENTRY="orderEntry",t.QUOTE_ENTRY="quoteEntry",t.SAVED_CART_ENTRY="savedCartEntry"})(r=e.OwnerType||(e.OwnerType={}))})(E||(E={}));var G=function(e){return e.CPQ="CLOUDCPQCONFIGURATOR",e.VARIANT="CPQCONFIGURATOR",e.TEXTFIELD="TEXTFIELD",e}(G||{}),_t="_READ_ONLY",qt=function(e){return e.Success="SUCCESS",e.Info="INFO",e.Warning="WARNING",e.Error="ERROR",e}(qt||{}),w=function(e){return e.KEY="KEY",e.NAME="NAME",e.QTY="QTY",e.FORMATTED_PRICE="FORMATTED_PRICE",e.PRICE_VALUE="PRICE_VALUE",e}(w||{}),W=function(e){return e.VERSION="CI#@#VERSION",e.CURRENCY="CI#@#CURRENCY",e.LINE_ITEM="LI",e.LINE_ITEM_DELIMITER="#",e}(W||{}),Z="INITIAL",tt=class e{static getOwnerKey(r,t){if(!t||!r)throw new Error("We expect an owner ID and an owner type");return r+"/"+t}static createInitialOwner(){return{key:Z,configuratorType:Z,id:Z,type:E.OwnerType.PRODUCT}}static isInitialOwner(r){return r.configuratorType===Z}static createOwner(r,t,n=G.VARIANT){return{type:r,id:t,configuratorType:n,key:e.getOwnerKey(r,t)}}},K=(()=>{class e{constructor(t){this.userIdService=t}setOwnerKey(t){t.key=tt.getOwnerKey(t.type,t.id)}getComposedOwnerId(t,n){return t+"+"+n}decomposeOwnerId(t){let n=t.split("+");if(n.length!==2)throw new Error("We only expect 2 parts in ownerId, separated by +, but was: "+t);return{documentId:n[0],entryNumber:n[1]}}getCartId(t){let n=t?.user?.uid===Ot?t.guid:t?.code;if(!n)throw new Error("Cart ID is not defined");return n}hasIssues(t){return this.getNumberOfIssues(t)>0}getNumberOfIssues(t){let n=0;return t?.statusSummaryList?.forEach(i=>{if(i.status===qt.Error){let l=i.numberOfIssues;n=l||0}}),n}isAttributeBasedConfigurator(t){return t?t===G.VARIANT||t===G.TEXTFIELD:!1}isBundleBasedConfigurator(t){return t?t===G.CPQ:!1}isActiveCartContext(t){return(t?.location$??h).pipe(O(n=>n!==mt.SaveForLater&&n!==mt.SavedCart))}getSlotsFromLayoutConfiguration(t,n,i,l){let p=t.layoutSlots;return p?p[n][i][l].slots:[]}static{this.\u0275fac=function(n){return new(n||e)(Q(Rt))}}static{this.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),yt=(()=>{class e{hasIssues(){return this.commonConfigUtilsService.hasIssues(this.cartEntry)}retrieveOwnerTypeFromAbstractOrderType(t){switch(t.type){case D.ORDER:return E.OwnerType.ORDER_ENTRY;case D.QUOTE:return E.OwnerType.QUOTE_ENTRY;case D.SAVED_CART:return E.OwnerType.SAVED_CART_ENTRY;default:return E.OwnerType.CART_ENTRY}}retrieveEntityKey(t){let n=this.cartEntry.entryNumber;if(n===void 0)throw new Error("No entryNumber present in entry");return t.type!==D.CART?this.commonConfigUtilsService.getComposedOwnerId(t.id,n):n.toString()}getRoute(){let t=this.cartEntry.product?.configuratorType;return!this.readOnly||t?.endsWith(_t)?"configure"+t:"configureOverview"+t}getDisplayOnly(){let t=this.cartEntry.product?.configuratorType;return this.readOnly||!t||t.endsWith(_t)}isDisabled(){return this.readOnly?!1:this.disabled}getResolveIssuesA11yDescription(){let t="cx-error-msg-"+this.cartEntry.entryNumber;return!this.getDisplayOnly()&&this.msgBanner?t:void 0}isInCheckout(){return this.routingService.getRouterState().pipe(O(t=>t.state.semanticRoute==="checkoutReviewOrder"))}constructor(t){this.commonConfigUtilsService=t,this.routingService=F($),this.abstractOrderContext=F(kt,{optional:!0}),this.abstractOrderKey$=this.abstractOrderContext?this.abstractOrderContext.key$:it({type:D.CART}),this.queryParams$=this.isInCheckout().pipe(O(n=>({forceReload:!0,resolveIssues:this.msgBanner&&this.hasIssues(),navigateToCheckout:n,productCode:this.cartEntry.product?.code})))}static{this.\u0275fac=function(n){return new(n||e)(I(K))}}static{this.\u0275cmp=b({type:e,selectors:[["cx-configure-cart-entry"]],inputs:{cartEntry:"cartEntry",readOnly:"readOnly",msgBanner:"msgBanner",disabled:"disabled"},standalone:!1,decls:2,vars:3,consts:[["configureText",""],[4,"ngIf"],["class","disabled-link",4,"ngIf"],["class","link cx-action-link","cxAutoFocus","",3,"routerLink","queryParams",4,"ngIf"],[1,"disabled-link"],[4,"ngIf","ngIfThen"],["cxAutoFocus","",1,"link","cx-action-link",3,"routerLink","queryParams"]],template:function(n,i){n&1&&(d(0,ne,4,1,"ng-container",1),s(1,"async")),n&2&&c("ngIf",u(1,1,i.abstractOrderKey$))},dependencies:[N,vt,B,Pt,M],encapsulation:2,changeDetection:0})}}return e})(),nt=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=T({type:e})}static{this.\u0275inj=v({imports:[P,k,A,q,gt]})}}return e})(),Oe=(()=>{class e{constructor(t,n){this.commonConfigUtilsService=t,this.cartItemContext=n,this.iconTypes=At,this.orderEntry$=this.cartItemContext?.item$??h,this.quantityControl$=this.cartItemContext?.quantityControl$??h,this.readonly$=this.cartItemContext?.readonly$??h,this.shouldShowButton$=this.commonConfigUtilsService.isActiveCartContext(this.cartItemContext)}hasIssues(t){return this.commonConfigUtilsService.hasIssues(t)}getNumberOfIssues(t){return this.commonConfigUtilsService.getNumberOfIssues(t)}getErrorMessageId(t){return"cx-error-msg-"+t.entryNumber}static{this.\u0275fac=function(n){return new(n||e)(I(K),I(z,8))}}static{this.\u0275cmp=b({type:e,selectors:[["cx-configurator-issues-notification"]],standalone:!1,decls:2,vars:3,consts:[[4,"ngIf"],[3,"type"],[3,"id"],["class","cx-error-msg-action",3,"cartEntry","readOnly","msgBanner","disabled",4,"ngIf"],[1,"cx-error-msg-action",3,"cartEntry","readOnly","msgBanner","disabled"]],template:function(n,i){n&1&&(d(0,ae,3,3,"ng-container",0),s(1,"async")),n&2&&c("ngIf",u(1,1,i.orderEntry$))},dependencies:[N,Dt,yt,B,M],encapsulation:2})}}return e})(),Wt=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=T({type:e})}static{this.\u0275inj=v({providers:[j({id:J.ITEM_CONFIGURATOR_ISSUES,position:V.REPLACE,component:Oe})],imports:[P,k,A,q,nt]})}}return e})(),Re=(()=>{class e{constructor(t,n){this.cartItemContext=t,this.commonConfigUtilsService=n,this.orderEntry$=this.cartItemContext?.item$??h,this.quantityControl$=this.cartItemContext?.quantityControl$??h,this.readonly$=this.cartItemContext?.readonly$??h,this.shouldShowButton$=this.commonConfigUtilsService.isActiveCartContext(this.cartItemContext)}hasStatus(t){let n=t.configurationInfos;return n?n.length>0&&n[0].status!=="NONE":!1}isAttributeBasedConfigurator(t){let n=t.configurationInfos;return n?this.commonConfigUtilsService.isAttributeBasedConfigurator(n[0]?.configuratorType):!1}getHiddenConfigurationInfoId(t){return"cx-configuration-hidden-info-"+t.toString()}static{this.\u0275fac=function(n){return new(n||e)(I(z,8),I(K))}}static{this.\u0275cmp=b({type:e,selectors:[["cx-configurator-cart-entry-info"]],standalone:!1,decls:2,vars:3,consts:[[4,"ngIf"],["class","cx-intro cx-visually-hidden",4,"ngIf"],["class","cx-configuration-info",4,"ngFor","ngForOf"],[1,"cx-intro","cx-visually-hidden"],[1,"cx-configuration-info"],[1,"cx-visually-hidden",3,"id"],["aria-hidden","true",1,"cx-label"],["aria-hidden","true",1,"cx-value"],[3,"cartEntry","readOnly","msgBanner","disabled",4,"ngIf"],[3,"cartEntry","readOnly","msgBanner","disabled"]],template:function(n,i){n&1&&(d(0,ge,2,1,"ng-container",0),s(1,"async")),n&2&&c("ngIf",u(1,1,i.orderEntry$))},dependencies:[ft,N,yt,B,M],encapsulation:2})}}return e})(),be=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=T({type:e})}static{this.\u0275inj=v({providers:[j({id:J.ITEM_DETAILS,position:V.AFTER,component:Re})],imports:[P,k,A,q,Wt,nt]})}}return e})(),Ct=function(e){return e.CONFIGURATOR="configurator",e.CONFIGURATOR_PRODUCT_CARD="configuratorProductCard",e}(Ct||{}),Vt=(()=>{class e{getProduct(){return this.productListItemContext?this.productListItemContext.product$:this.currentProductService?this.currentProductService.getProduct([Nt.DETAILS,Ct.CONFIGURATOR]):it(null)}getAriaLabelTranslationKey(t){return this.isConfiguratorTypeReadOnly(t)?"configurator.a11y.showDetailsProduct":"configurator.a11y.configureProduct"}getTranslationKey(t){return this.isConfiguratorTypeReadOnly(t)?"configurator.header.toConfigReadOnly":"configurator.header.toconfig"}isDisplayRestartDialog(t){return this.isConfiguratorTypeReadOnly(t)?"false":"true"}isReadOnlyBaseProduct(t){return this.isConfiguratorTypeReadOnly(t.configuratorType)&&this.isBaseProduct(t)}isBaseProduct(t){return!t.baseProduct||t.baseProduct===t.code}navigateToConfigurator(t){this.routingService?.go({cxRoute:"configure"+t.configuratorType,params:{ownerType:this.ownerTypeProduct,entityKey:t.code}},{queryParams:{displayRestartDialog:this.isDisplayRestartDialog(t.configuratorType),productCode:t.code}})}isConfiguratorTypeReadOnly(t){return!!t&&t.trim().endsWith(_t)}constructor(t,n){this.productListItemContext=t,this.currentProductService=n,this.nonConfigurable={configurable:!1},this.product$=this.getProduct().pipe(O(i=>i||this.nonConfigurable)),this.ownerTypeProduct=E.OwnerType.PRODUCT,this.routingService=F($,{optional:!0})}static{this.\u0275fac=function(n){return new(n||e)(I($t,8),I(Ft,8))}}static{this.\u0275cmp=b({type:e,selectors:[["cx-configure-product"]],standalone:!1,decls:2,vars:3,consts:[[4,"ngIf"],["cxAutoFocus","",1,"btn","btn-primary","btn-block",3,"click"]],template:function(n,i){n&1&&(d(0,_e,2,1,"ng-container",0),s(1,"async")),n&2&&c("ngIf",u(1,1,i.product$))},dependencies:[N,B,M],encapsulation:2,changeDetection:0})}}return e})(),Se=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=T({type:e})}static{this.\u0275inj=v({providers:[j({id:Ut.ITEM_ACTIONS,position:V.AFTER,component:Vt})],imports:[P,gt,St.withConfig({cmsComponents:{ConfigureProductComponent:{component:Vt}}}),k,A,q,Lt]})}}return e})(),Ne=(()=>{class e{constructor(){this.logger=F(bt)}retrieveLineItems(t){let n=[];if(t.configurationInfos){let i=t.configurationInfos.filter(x=>x&&(x.configurationLabel||x.configurationValue)),l=i[0]?.configurationLabel,p=i[0]?.configurationValue;l!==W.VERSION?i.forEach(x=>n.push(this.prepareLineItem(x))):l===W.VERSION&&Number(p)>=2?n=this.processConfigurationInfos(i):this.logWarning("Wrong ConfigurationInfo version")}return n}prepareLineItem(t){let n=t.configurationValue?t.configurationValue.split("x"):[];return{name:t.configurationLabel?this.removeDelimiter(t.configurationLabel):"",formattedQuantity:n.length>=1?n[0].trim():"",formattedPrice:n.length>=2?n[1].trim():""}}removeDelimiter(t){let n=t.trim();return n.charAt(n.length-1)===":"&&(n=n.substring(0,n.length-1)),n}processConfigurationInfos(t){let n=new Map;t.forEach(p=>this.processConfigurationInfoEntry(n,p));let i=new Map(Array.from(n).sort((p,x)=>p[0]-x[0]));return Array.from(i.values())}processConfigurationInfoEntry(t,n){if(n.configurationLabel){let i=n.configurationLabel.split(W.LINE_ITEM_DELIMITER);if(i[0]===W.LINE_ITEM){let l=n.configurationValue?n.configurationValue:"";this.addLineItemData(t,i,l)}}}addLineItemData(t,n,i){if(n.length===3){let l=Number(n[1]),p;switch(n[2]){case w.NAME:p=this.getOrCreateLineItem(t,l),p.name=i;break;case w.QTY:p=this.getOrCreateLineItem(t,l),p.formattedQuantity=i;break;case w.FORMATTED_PRICE:p=this.getOrCreateLineItem(t,l),p.formattedPrice=i;break;case w.KEY:case w.PRICE_VALUE:break;default:this.logWarning("Wrong LineItem format")}}else this.logWarning("Wrong LineItem format")}getOrCreateLineItem(t,n){let i=t.get(n)??{name:"",formattedQuantity:"",formattedPrice:""};return t.get(n)||t.set(n,i),i}logWarning(t){Et()&&this.logger.warn(t)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Be=(()=>{class e{constructor(t,n,i,l,p){this.commonConfigUtilsService=t,this.configCartEntryBundleInfoService=n,this.breakpointService=i,this.translation=l,this.cartItemContext=p,this.orderEntry$=this.cartItemContext?.item$??h,this.quantityControl$=this.cartItemContext?.quantityControl$??h,this.readonly$=this.cartItemContext?.readonly$??h,this.hideItems=!0,this.lineItems$=this.orderEntry$.pipe(O(x=>this.configCartEntryBundleInfoService.retrieveLineItems(x))),this.numberOfLineItems$=this.lineItems$.pipe(O(x=>x.length)),this.shouldShowButton$=this.commonConfigUtilsService.isActiveCartContext(this.cartItemContext)}toggleItems(){this.hideItems=!this.hideItems}isBundleBasedConfigurator(t){let n=t.configurationInfos;return n?this.commonConfigUtilsService.isBundleBasedConfigurator(n[0]?.configuratorType):!1}getButtonText(t){return t||(t=""),this.hideItems?this.translation.translate("configurator.header.show").pipe(R(1)).subscribe(n=>t+=n):this.translation.translate("configurator.header.hide").pipe(R(1)).subscribe(n=>t+=n),t}getItemsMsg(t){let n="";return this.translation.translate("configurator.a11y.cartEntryBundleInfo",{items:t}).pipe(R(1)).subscribe(i=>n=i),this.getButtonText(n)}getHiddenItemInfo(t){let n="";return t.name&&t.formattedPrice&&t.formattedQuantity?this.translation.translate("configurator.a11y.cartEntryBundle",{name:t.name,price:t.formattedPrice,quantity:t.formattedQuantity}).pipe(R(1)).subscribe(i=>n=i):t.name&&t.formattedPrice?this.translation.translate("configurator.a11y.cartEntryBundleNameWithPrice",{name:t.name,price:t.formattedPrice}).pipe(R(1)).subscribe(i=>n=i):t.name&&t.formattedQuantity?this.translation.translate("configurator.a11y.cartEntryBundleNameWithQuantity",{name:t.name,quantity:t.formattedQuantity}).pipe(R(1)).subscribe(i=>n=i):this.translation.translate("configurator.a11y.cartEntryBundleName",{name:t.name}).pipe(R(1)).subscribe(i=>n=i),n}getHiddenItemInfoId(t){return"cx-item-hidden-info-"+t.toString()}static{this.\u0275fac=function(n){return new(n||e)(I(K),I(Ne),I(wt),I(Bt),I(z,8))}}static{this.\u0275cmp=b({type:e,selectors:[["cx-configurator-cart-entry-bundle-info"]],standalone:!1,decls:2,vars:3,consts:[[4,"ngIf"],[1,"cx-number-items"],[3,"click"],[1,"cx-toggle-hide-items"],[1,"cx-item-infos"],["class","cx-item-info",4,"ngFor","ngForOf"],[1,"cx-item-info"],[1,"cx-visually-hidden",3,"id"],["aria-hidden","true",1,"cx-item-name"],["aria-hidden","true",1,"cx-item-quantity"],["aria-hidden","true",1,"cx-item-price"],[1,"cx-identifier"],[1,"cx-item"],[3,"cartEntry","readOnly","msgBanner","disabled",4,"ngIf"],[3,"cartEntry","readOnly","msgBanner","disabled"]],template:function(n,i){n&1&&(d(0,Te,2,1,"ng-container",0),s(1,"async")),n&2&&c("ngIf",u(1,1,i.orderEntry$))},dependencies:[ft,N,yt,B,M,Mt],encapsulation:2})}}return e})(),Pe=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=T({type:e})}static{this.\u0275inj=v({providers:[j({id:J.ITEM_BUNDLE_DETAILS,position:V.AFTER,component:Be})],imports:[P,A,nt]})}}return e})(),Me=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=T({type:e})}static{this.\u0275inj=v({imports:[Wt,be,Pe,nt,Se]})}}return e})(),Ae={backend:{occ:{endpoints:{product:{configurator:"products/${productCode}?fields=code,configurable,configuratorType",configuratorProductCard:"products/${productCode}?fields=code,description,images(DEFAULT)"}}},loadingScopes:{product:{list:{include:[Ct.CONFIGURATOR]}}}}},De=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=T({type:e})}static{this.\u0275inj=v({providers:[Tt(Ae)]})}}return e})(),on=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=T({type:e})}static{this.\u0275inj=v({imports:[De,Me]})}}return e})(),et;(function(e){let r;(function(t){t.CONFIGURATION="configuration",t.OVERVIEW="overview"})(r=e.PageType||(e.PageType={}))})(et||(et={}));var an=(()=>{class e{constructor(t,n){this.configUtilsService=t,this.routingService=n,this.ROUTE_FRAGMENT_CONFIGURE="configure",this.ROUTE_FRAGMENT_OVERVIEW="configureOverview"}extractRouterData(){return this.routingService.getRouterState().pipe(rt(t=>t.state.params.entityKey),rt(t=>t.nextState===void 0),O(t=>{let n=this.createOwnerFromRouterState(t),i=t.state.semanticRoute;return{owner:n,isOwnerCartEntry:n.type===E.OwnerType.CART_ENTRY,displayOnly:t.state.params.displayOnly,resolveIssues:t.state.queryParams?.resolveIssues==="true",skipConflicts:t.state.queryParams?.skipConflicts==="true",forceReload:t.state.queryParams?.forceReload==="true",expMode:t.state.queryParams?.expMode==="true",displayRestartDialog:t.state.queryParams?.displayRestartDialog==="true",configIdTemplate:t.state.queryParams?.configIdTemplate,navigationId:t.navigationId,pageType:i&&i.includes(this.ROUTE_FRAGMENT_OVERVIEW)?et.PageType.OVERVIEW:et.PageType.CONFIGURATION,navigateToCheckout:t.state.queryParams?.navigateToCheckout==="true",productCode:t.state.queryParams?.productCode}}))}createOwnerFromRouterState(t){let n=tt.createInitialOwner(),i=t.state.params;if(i.ownerType){let p=i.entityKey;n.type=i.ownerType,n.id=p}else n.type=E.OwnerType.PRODUCT,n.id=i.rootProduct;let l=t.state.semanticRoute;if(l){let p=this.getConfiguratorTypeFromSemanticRoute(l);n.configuratorType=p}return this.configUtilsService.setOwnerKey(n),n}getConfiguratorTypeFromSemanticRoute(t){if(t.startsWith(this.ROUTE_FRAGMENT_OVERVIEW))return t.split(this.ROUTE_FRAGMENT_OVERVIEW)[1];if(t.startsWith(this.ROUTE_FRAGMENT_CONFIGURE))return t.split(this.ROUTE_FRAGMENT_CONFIGURE)[1];throw new Error("Not able to determine configurator type")}static{this.\u0275fac=function(n){return new(n||e)(Q(K),Q($))}}static{this.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();export{E as a,G as b,tt as c,K as d,Ct as e,on as f,et as g,an as h};
